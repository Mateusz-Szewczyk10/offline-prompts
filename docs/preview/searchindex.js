Search.setIndex({"docnames": ["documentation/_autosummary/dataset/off_prompts.dataset.assets.reward_finetuner", "documentation/_autosummary/dataset/off_prompts.dataset.assets.reward_finetuner.MovielensDataset", "documentation/_autosummary/dataset/off_prompts.dataset.assets.reward_finetuner.RewardFinetuner", "documentation/_autosummary/dataset/off_prompts.dataset.assets.sentence_embedding_learner", "documentation/_autosummary/dataset/off_prompts.dataset.assets.sentence_embedding_learner.SentenceEmbeddingLearner", "documentation/_autosummary/dataset/off_prompts.dataset.base", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseCandidateActionsLoader", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseContextQueryLoader", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseEncoder", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseFrozenLLM", "documentation/_autosummary/dataset/off_prompts.dataset.base.BasePromptFormatter", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseRewardSimulator", "documentation/_autosummary/dataset/off_prompts.dataset.benchmark", "documentation/_autosummary/dataset/off_prompts.dataset.benchmark.SemiSyntheticDataset", "documentation/_autosummary/dataset/off_prompts.dataset.encoder", "documentation/_autosummary/dataset/off_prompts.dataset.encoder.BatchDataset", "documentation/_autosummary/dataset/off_prompts.dataset.encoder.NNSentenceEncoder", "documentation/_autosummary/dataset/off_prompts.dataset.encoder.TransformerEncoder", "documentation/_autosummary/dataset/off_prompts.dataset.frozen_llm", "documentation/_autosummary/dataset/off_prompts.dataset.frozen_llm.AutoFrozenLLM", "documentation/_autosummary/dataset/off_prompts.dataset.function", "documentation/_autosummary/dataset/off_prompts.dataset.function.DefaultCandidateActionsLoader", "documentation/_autosummary/dataset/off_prompts.dataset.function.DefaultContextQueryLoader", "documentation/_autosummary/dataset/off_prompts.dataset.prompt_formatter", "documentation/_autosummary/dataset/off_prompts.dataset.prompt_formatter.MovielensPromptFormatter", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.CollaborativeFilteringRewardSimulator", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.PromptCossimRewardSimulator", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.SentenceCossimRewardSimulator", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.TransformerRewardSimulator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.AuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.CandidateActionsGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedExponentialAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedPowerAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedRationalAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedTrigonometricAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ContextQueryGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ExponentialAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.MixtureOfGaussianCandidateActionsGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.PowerAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.RationalAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.RewardSimulator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.SigmoidAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.SparseRewardSimulator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.TrigonometricAuxiliaryOutputGenerator", "documentation/_autosummary/dataset/off_prompts_syn.dataset.synthetic", "documentation/_autosummary/dataset/off_prompts_syn.dataset.synthetic.SyntheticDataset", "documentation/_autosummary/opl/off_prompts.opl.behavior_cloning", "documentation/_autosummary/opl/off_prompts.opl.dataset", "documentation/_autosummary/opl/off_prompts.opl.marginal_learner", "documentation/_autosummary/opl/off_prompts.opl.policy_evaluator", "documentation/_autosummary/opl/off_prompts.opl.policy_learner", "documentation/_autosummary/opl/off_prompts.opl.reward_learner", "documentation/_autosummary/opl/off_prompts_syn.opl.behavior_cloning", "documentation/_autosummary/opl/off_prompts_syn.opl.marginal_learner", "documentation/_autosummary/opl/off_prompts_syn.opl.policy_learner", "documentation/_autosummary/opl/off_prompts_syn.opl.reward_learner", "documentation/_autosummary/policy/off_prompts.policy.base", "documentation/_autosummary/policy/off_prompts.policy.model", "documentation/_autosummary/policy/off_prompts.policy.policy", "documentation/_autosummary/policy/off_prompts_syn.policy.base", "documentation/_autosummary/policy/off_prompts_syn.policy.model", "documentation/_autosummary/policy/off_prompts_syn.policy.policy", "documentation/_autosummary/utils/off_prompts.utils", "documentation/_autosummary/utils/off_prompts.utils.FrozenLLMDataset", "documentation/_autosummary/utils/off_prompts.utils.RewardSimulatorDataset", "documentation/_autosummary/utils/off_prompts.utils.check_logged_feedback", "documentation/_autosummary/utils/off_prompts.utils.check_tensor", "documentation/_autosummary/utils/off_prompts.utils.defaultdict_to_dict", "documentation/_autosummary/utils/off_prompts.utils.gaussian_kernel", "documentation/_autosummary/utils/off_prompts.utils.to_device", "documentation/_autosummary/utils/off_prompts.utils.tokenize", "documentation/_autosummary/utils/off_prompts.utils.torch_seed", "documentation/_autosummary/utils/off_prompts.utils.uniform_kernel", "documentation/_autosummary/utils/off_prompts_syn.utils", "documentation/_autosummary/utils/off_prompts_syn.utils.check_logged_feedback", "documentation/_autosummary/utils/off_prompts_syn.utils.check_tensor", "documentation/_autosummary/utils/off_prompts_syn.utils.defaultdict_to_dict", "documentation/_autosummary/utils/off_prompts_syn.utils.gaussian_kernel", "documentation/_autosummary/utils/off_prompts_syn.utils.torch_seed", "documentation/_autosummary/utils/off_prompts_syn.utils.uniform_kernel", "documentation/api", "documentation/distinctive_features", "documentation/dso", "documentation/implementations", "documentation/index", "documentation/installation", "documentation/news", "documentation/quickstart", "documentation/usage", "index"], "filenames": ["documentation/_autosummary/dataset/off_prompts.dataset.assets.reward_finetuner.rst", "documentation/_autosummary/dataset/off_prompts.dataset.assets.reward_finetuner.MovielensDataset.rst", "documentation/_autosummary/dataset/off_prompts.dataset.assets.reward_finetuner.RewardFinetuner.rst", "documentation/_autosummary/dataset/off_prompts.dataset.assets.sentence_embedding_learner.rst", "documentation/_autosummary/dataset/off_prompts.dataset.assets.sentence_embedding_learner.SentenceEmbeddingLearner.rst", "documentation/_autosummary/dataset/off_prompts.dataset.base.rst", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseCandidateActionsLoader.rst", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseContextQueryLoader.rst", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseEncoder.rst", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseFrozenLLM.rst", "documentation/_autosummary/dataset/off_prompts.dataset.base.BasePromptFormatter.rst", "documentation/_autosummary/dataset/off_prompts.dataset.base.BaseRewardSimulator.rst", "documentation/_autosummary/dataset/off_prompts.dataset.benchmark.rst", "documentation/_autosummary/dataset/off_prompts.dataset.benchmark.SemiSyntheticDataset.rst", "documentation/_autosummary/dataset/off_prompts.dataset.encoder.rst", "documentation/_autosummary/dataset/off_prompts.dataset.encoder.BatchDataset.rst", "documentation/_autosummary/dataset/off_prompts.dataset.encoder.NNSentenceEncoder.rst", "documentation/_autosummary/dataset/off_prompts.dataset.encoder.TransformerEncoder.rst", "documentation/_autosummary/dataset/off_prompts.dataset.frozen_llm.rst", "documentation/_autosummary/dataset/off_prompts.dataset.frozen_llm.AutoFrozenLLM.rst", "documentation/_autosummary/dataset/off_prompts.dataset.function.rst", "documentation/_autosummary/dataset/off_prompts.dataset.function.DefaultCandidateActionsLoader.rst", "documentation/_autosummary/dataset/off_prompts.dataset.function.DefaultContextQueryLoader.rst", "documentation/_autosummary/dataset/off_prompts.dataset.prompt_formatter.rst", "documentation/_autosummary/dataset/off_prompts.dataset.prompt_formatter.MovielensPromptFormatter.rst", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.rst", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.CollaborativeFilteringRewardSimulator.rst", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.PromptCossimRewardSimulator.rst", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.SentenceCossimRewardSimulator.rst", "documentation/_autosummary/dataset/off_prompts.dataset.reward_simulator.TransformerRewardSimulator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.AuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.CandidateActionsGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedExponentialAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedPowerAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedRationalAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ConfoundedTrigonometricAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ContextQueryGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.ExponentialAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.MixtureOfGaussianCandidateActionsGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.PowerAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.RationalAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.RewardSimulator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.SigmoidAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.SparseRewardSimulator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.function.TrigonometricAuxiliaryOutputGenerator.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.synthetic.rst", "documentation/_autosummary/dataset/off_prompts_syn.dataset.synthetic.SyntheticDataset.rst", "documentation/_autosummary/opl/off_prompts.opl.behavior_cloning.rst", "documentation/_autosummary/opl/off_prompts.opl.dataset.rst", "documentation/_autosummary/opl/off_prompts.opl.marginal_learner.rst", "documentation/_autosummary/opl/off_prompts.opl.policy_evaluator.rst", "documentation/_autosummary/opl/off_prompts.opl.policy_learner.rst", "documentation/_autosummary/opl/off_prompts.opl.reward_learner.rst", "documentation/_autosummary/opl/off_prompts_syn.opl.behavior_cloning.rst", "documentation/_autosummary/opl/off_prompts_syn.opl.marginal_learner.rst", "documentation/_autosummary/opl/off_prompts_syn.opl.policy_learner.rst", "documentation/_autosummary/opl/off_prompts_syn.opl.reward_learner.rst", "documentation/_autosummary/policy/off_prompts.policy.base.rst", "documentation/_autosummary/policy/off_prompts.policy.model.rst", "documentation/_autosummary/policy/off_prompts.policy.policy.rst", "documentation/_autosummary/policy/off_prompts_syn.policy.base.rst", "documentation/_autosummary/policy/off_prompts_syn.policy.model.rst", "documentation/_autosummary/policy/off_prompts_syn.policy.policy.rst", "documentation/_autosummary/utils/off_prompts.utils.rst", "documentation/_autosummary/utils/off_prompts.utils.FrozenLLMDataset.rst", "documentation/_autosummary/utils/off_prompts.utils.RewardSimulatorDataset.rst", "documentation/_autosummary/utils/off_prompts.utils.check_logged_feedback.rst", "documentation/_autosummary/utils/off_prompts.utils.check_tensor.rst", "documentation/_autosummary/utils/off_prompts.utils.defaultdict_to_dict.rst", "documentation/_autosummary/utils/off_prompts.utils.gaussian_kernel.rst", "documentation/_autosummary/utils/off_prompts.utils.to_device.rst", "documentation/_autosummary/utils/off_prompts.utils.tokenize.rst", "documentation/_autosummary/utils/off_prompts.utils.torch_seed.rst", "documentation/_autosummary/utils/off_prompts.utils.uniform_kernel.rst", "documentation/_autosummary/utils/off_prompts_syn.utils.rst", "documentation/_autosummary/utils/off_prompts_syn.utils.check_logged_feedback.rst", "documentation/_autosummary/utils/off_prompts_syn.utils.check_tensor.rst", "documentation/_autosummary/utils/off_prompts_syn.utils.defaultdict_to_dict.rst", "documentation/_autosummary/utils/off_prompts_syn.utils.gaussian_kernel.rst", "documentation/_autosummary/utils/off_prompts_syn.utils.torch_seed.rst", "documentation/_autosummary/utils/off_prompts_syn.utils.uniform_kernel.rst", "documentation/api.rst", "documentation/distinctive_features.rst", "documentation/dso.rst", "documentation/implementations.rst", "documentation/index.rst", "documentation/installation.rst", "documentation/news.rst", "documentation/quickstart.rst", "documentation/usage.rst", "index.rst"], "titles": ["off_prompts.dataset.assets.reward_finetuner", "off_prompts.dataset.assets.reward_finetuner.MovielensDataset", "off_prompts.dataset.assets.reward_finetuner.RewardFinetuner", "off_prompts.dataset.assets.sentence_embedding_learner", "off_prompts.dataset.assets.sentence_embedding_learner.SentenceEmbeddingLearner", "off_prompts.dataset.base", "off_prompts.dataset.base.BaseCandidateActionsLoader", "off_prompts.dataset.base.BaseContextQueryLoader", "off_prompts.dataset.base.BaseEncoder", "off_prompts.dataset.base.BaseFrozenLLM", "off_prompts.dataset.base.BasePromptFormatter", "off_prompts.dataset.base.BaseRewardSimulator", "off_prompts.dataset.benchmark", "off_prompts.dataset.benchmark.SemiSyntheticDataset", "off_prompts.dataset.encoder", "off_prompts.dataset.encoder.BatchDataset", "off_prompts.dataset.encoder.NNSentenceEncoder", "off_prompts.dataset.encoder.TransformerEncoder", "off_prompts.dataset.frozen_llm", "off_prompts.dataset.frozen_llm.AutoFrozenLLM", "off_prompts.dataset.function", "off_prompts.dataset.function.DefaultCandidateActionsLoader", "off_prompts.dataset.function.DefaultContextQueryLoader", "off_prompts.dataset.prompt_formatter", "off_prompts.dataset.prompt_formatter.MovielensPromptFormatter", "off_prompts.dataset.reward_simulator", "off_prompts.dataset.reward_simulator.CollaborativeFilteringRewardSimulator", "off_prompts.dataset.reward_simulator.PromptCossimRewardSimulator", "off_prompts.dataset.reward_simulator.SentenceCossimRewardSimulator", "off_prompts.dataset.reward_simulator.TransformerRewardSimulator", "off_prompts_syn.dataset.function", "off_prompts_syn.dataset.function.AuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.CandidateActionsGenerator", "off_prompts_syn.dataset.function.ConfoundedAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.ConfoundedExponentialAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.ConfoundedPowerAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.ConfoundedRationalAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.ConfoundedTrigonometricAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.ContextQueryGenerator", "off_prompts_syn.dataset.function.ExponentialAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.MixtureOfGaussianCandidateActionsGenerator", "off_prompts_syn.dataset.function.PowerAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.RationalAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.RewardSimulator", "off_prompts_syn.dataset.function.SigmoidAuxiliaryOutputGenerator", "off_prompts_syn.dataset.function.SparseRewardSimulator", "off_prompts_syn.dataset.function.TrigonometricAuxiliaryOutputGenerator", "off_prompts_syn.dataset.synthetic", "off_prompts_syn.dataset.synthetic.SyntheticDataset", "off_prompts.opl.behavior_cloning", "off_prompts.opl.dataset", "off_prompts.opl.marginal_learner", "off_prompts.opl.policy_evaluator", "off_prompts.opl.policy_learner", "off_prompts.opl.reward_learner", "off_prompts_syn.opl.behavior_cloning", "off_prompts_syn.opl.marginal_learner", "off_prompts_syn.opl.policy_learner", "off_prompts_syn.opl.reward_learner", "off_prompts.policy.base", "off_prompts.policy.model", "off_prompts.policy.policy", "off_prompts_syn.policy.base", "off_prompts_syn.policy.model", "off_prompts_syn.policy.policy", "off_prompts.utils", "off_prompts.utils.FrozenLLMDataset", "off_prompts.utils.RewardSimulatorDataset", "off_prompts.utils.check_logged_feedback", "off_prompts.utils.check_tensor", "off_prompts.utils.defaultdict_to_dict", "off_prompts.utils.gaussian_kernel", "off_prompts.utils.to_device", "off_prompts.utils.tokenize", "off_prompts.utils.torch_seed", "off_prompts.utils.uniform_kernel", "off_prompts_syn.utils", "off_prompts_syn.utils.check_logged_feedback", "off_prompts_syn.utils.check_tensor", "off_prompts_syn.utils.defaultdict_to_dict", "off_prompts_syn.utils.gaussian_kernel", "off_prompts_syn.utils.torch_seed", "off_prompts_syn.utils.uniform_kernel", "OfflinePrompts Package Reference", "Why OfflinePrompts?", "DSO for Data-Efficient OPL", "Problem Formulation and Implementations", "OfflinePrompts", "Installation", "News", "Quickstart", "Usage", "Welcome!"], "terms": {"learner": [0, 3, 4], "class": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 66, 67, 76, 81, 91], "reward": [0, 1, 2, 5, 11, 12, 13, 25, 26, 27, 28, 29, 30, 43, 45, 47, 48, 65, 67, 68, 76, 77, 84, 85, 86, 87, 92], "simul": [0, 2, 5, 11, 12, 13, 20, 21, 25, 26, 27, 28, 29, 30, 43, 45, 47, 48, 65, 67, 68, 76, 77, 84, 92], "movielensdataset": 0, "df": [0, 1, 2], "user_id_column": [0, 1, 2], "user_id": [0, 1, 2, 5, 7, 11, 12, 13, 20, 22, 25, 26, 27, 28, 29, 65, 67, 91], "item_id_column": [0, 1, 2], "item_id": [0, 1, 2, 5, 7, 11, 12, 13, 20, 22, 25, 26, 27, 28, 29, 65, 67, 91], "sentence_column": [0, 1, 2], "descript": [0, 1, 2, 23, 24, 87, 91, 92], "reward_column": [0, 1, 2], "token": [0, 1, 2, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 23, 24, 25, 28, 29, 65, 66, 67], "none": [0, 1, 2, 3, 4, 5, 8, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 69, 73, 76, 78, 91], "tokenizer_kwarg": [0, 1, 2, 14, 17, 18, 19, 23, 24, 25, 29, 65, 73], "devic": [0, 1, 11, 12, 13, 14, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 72, 73, 74, 76, 81, 91], "cuda": [0, 1, 11, 12, 13, 14, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 72, 73, 74, 91], "sourc": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 88], "torch": [0, 1, 2, 3, 4, 5, 7, 8, 11, 12, 13, 14, 16, 17, 20, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 66, 67, 68, 71, 72, 75, 76, 77, 91], "movielen": [0, 1, 2, 85, 87, 92], "base": [0, 1, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 47, 48, 65, 66, 67, 85, 86, 87, 91, 92], "util": [0, 1, 11, 16, 26, 27, 28, 29], "data": [0, 1, 2, 3, 4, 12, 13, 14, 15, 20, 22, 47, 48, 65, 66, 67, 68, 76, 77, 86, 88, 92], "import": [0, 1, 2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 29, 47, 48, 65, 66, 67, 84, 87, 91], "paramet": [0, 1, 2, 3, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 86], "datafram": [0, 1, 2], "panda": [0, 1, 2], "preprocess": [0, 1, 2], "str": [0, 1, 2, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 69, 72, 73, 74, 76, 78, 81, 91], "default": [0, 1, 2, 3, 4, 5, 8, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 69, 71, 72, 73, 74, 75, 76, 78, 85, 91], "column": [0, 1, 2, 91], "name": [0, 1, 2, 11, 12, 13, 16, 23, 24, 26, 27, 28, 29, 65, 69, 76, 78, 91], "user": [0, 1, 2, 5, 7, 8, 9, 11, 12, 13, 14, 16, 18, 19, 20, 22, 25, 26, 27, 28, 29, 30, 38, 47, 48, 65, 67, 68, 76, 77, 84, 85, 86, 87, 92], "id": [0, 1, 2, 5, 7, 11, 12, 13, 20, 22, 25, 26, 27, 28, 29, 65, 67, 86, 91], "item": [0, 1, 2, 5, 7, 11, 12, 13, 16, 20, 22, 25, 26, 27, 28, 29, 65, 67, 84, 87, 91], "sentenc": [0, 1, 2, 3, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 27, 28, 29, 47, 48, 65, 67, 68, 71, 73, 75, 76, 77, 84, 87, 88, 92], "pretrainedtoken": [0, 1, 2, 14, 17, 18, 19, 25, 29, 65, 73], "pretrainedtokenizerfast": [0, 1, 2, 14, 17, 18, 19, 25, 29, 65, 73], "frozen": [0, 1, 2, 5, 9, 11, 12, 13, 18, 19, 23, 24, 25, 27, 28, 29, 65, 66, 68, 73, 76, 77, 84, 85, 86, 87, 91, 92], "llm": [0, 1, 2, 5, 9, 11, 12, 13, 18, 19, 23, 24, 25, 28, 29, 65, 66, 68, 73, 76, 77, 86, 87, 92], "dict": [0, 1, 2, 3, 4, 11, 12, 13, 14, 16, 17, 18, 19, 25, 26, 27, 28, 29, 47, 48, 65, 70, 72, 73, 76, 79], "kwarg": [0, 1, 2, 5, 11, 14, 16, 17, 18, 19, 25, 26, 27, 28, 29, 65, 73], "rewardfinetun": 0, "model": [0, 2, 3, 4, 5, 8, 11, 12, 13, 14, 15, 16, 17, 18, 19, 25, 26, 27, 28, 29, 84, 85, 86, 87, 91], "optim": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 91, 92], "adam": [0, 2, 3, 4], "optimizer_kwarg": [0, 2, 3, 4], "random_st": [0, 2, 3, 4, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 74, 76, 81, 91], "finetun": [0, 2, 11, 16, 25, 26, 27, 28, 29], "baserewardsimul": [0, 2, 5, 12, 13, 25, 29], "an": [0, 2, 3, 4, 11, 14, 16, 26, 27, 28, 29, 84, 85, 86, 87], "instanc": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29], "argument": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29], "int": [0, 2, 3, 4, 5, 7, 8, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 69, 74, 76, 78, 91], "random": [0, 2, 3, 4, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 74, 85, 86], "state": [0, 2, 3, 4, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 74], "attribut": [0, 2, 3, 4, 11, 12, 13, 16, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48], "method": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 66, 67, 85, 88, 92], "alia": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29], "init_with_reference_model": [0, 2], "parent_model": [0, 2], "initi": [0, 2, 11, 16, 26, 27, 28, 29, 84, 91], "embed": [0, 2, 3, 4, 5, 8, 12, 13, 14, 16, 17, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 44, 46, 47, 48, 65, 68, 76, 77, 85, 86], "bias": [0, 2], "from": [0, 2, 11, 12, 13, 16, 25, 26, 27, 28, 29, 47, 48, 84, 85, 86, 87, 88, 91], "parent": [0, 2], "inherit": [0, 2], "weight": [0, 2, 11, 16, 26, 27, 28, 29, 65, 71, 75, 84, 85, 86], "load": [0, 2, 3, 4, 5, 8, 14, 16, 17, 65, 72, 91], "path": [0, 2, 3, 4, 5, 8, 11, 12, 13, 14, 16, 17, 20, 21, 22, 26, 27, 28, 29, 91], "is_init": [0, 2, 3, 4], "fals": [0, 2, 3, 4, 11, 12, 13, 14, 16, 17, 20, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48, 91], "save": [0, 2, 3, 4, 5, 8, 11, 14, 16, 17, 26, 27, 28, 29, 91], "seed": [0, 2, 3, 4, 65, 74, 76, 81], "fix": [0, 2, 3, 4], "finetune_model": [0, 2], "loss_typ": [0, 2], "mse": [0, 2, 85], "n_epoch": [0, 2, 3, 4], "100": [0, 2, 3, 4, 11, 12, 13, 14, 16, 25, 26, 27, 28, 29, 30, 40, 85], "n_steps_per_epoch": [0, 2, 3, 4], "return_training_process": [0, 2, 3, 4], "batch_siz": [0, 2, 3, 4, 5, 8, 14, 16, 17, 18, 19, 25, 29], "16": [0, 2, 11, 16, 26, 27, 28, 29], "mask_ratio": [0, 2], "0": [0, 2, 3, 4, 5, 8, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 71, 74, 75, 76, 80, 82, 85, 86, 91], "1": [0, 2, 11, 12, 13, 14, 16, 17, 26, 27, 28, 29, 30, 33, 34, 35, 36, 37, 39, 40, 41, 44, 46, 47, 48, 65, 69, 71, 75, 76, 78, 80, 82, 85, 86, 91], "random_token_ratio": [0, 2], "val_ratio": [0, 2], "2": [0, 2, 11, 12, 13, 14, 16, 17, 26, 27, 28, 29, 85, 86, 91], "shuffl": [0, 2, 20, 22], "make_copi": [0, 2, 3, 4], "save_path": [0, 2, 3, 4], "fine": [0, 2, 3, 4, 12, 13, 25], "tune": [0, 2, 3, 4, 12, 13, 25, 84, 85], "bce": [0, 2], "whether": [0, 2, 3, 4, 11, 12, 13, 14, 16, 17, 20, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48, 86], "us": [0, 2, 5, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 25, 26, 27, 28, 29, 47, 48, 65, 68, 76, 77, 85, 86, 87, 88, 91, 92], "mean": [0, 2, 85, 86], "squar": [0, 2], "error": [0, 2, 11, 16, 26, 27, 28, 29], "loss": [0, 2, 85, 86], "binari": [0, 2, 12, 13, 47, 48, 65, 68, 76, 77, 91], "cross": [0, 2], "entropi": [0, 2], "number": [0, 2, 3, 4, 5, 7, 11, 12, 13, 16, 20, 21, 22, 25, 26, 27, 28, 29, 30, 32, 38, 40, 47, 48, 85, 86, 91], "epoch": [0, 2, 3, 4], "train": [0, 2, 3, 4, 11, 16, 20, 22, 26, 27, 28, 29, 84, 85, 86, 87, 91], "gradient": [0, 2, 3, 4, 11, 14, 16, 25, 26, 27, 28, 29, 87], "step": [0, 2, 3, 4], "within": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29, 84, 85, 86], "bool": [0, 2, 3, 4, 11, 12, 13, 14, 16, 17, 20, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48], "return": [0, 2, 3, 4, 5, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 65, 70, 71, 72, 73, 75], "log": [0, 2, 3, 4, 5, 12, 13, 20, 22, 47, 48, 65, 68, 76, 77, 84, 85, 86, 87, 88, 91, 92], "32": [0, 2, 3, 4], "batch": [0, 2, 5, 8, 14, 16, 17, 18, 19, 25, 29, 86], "size": [0, 2, 5, 8, 11, 12, 13, 14, 16, 17, 18, 19, 25, 26, 27, 28, 29, 47, 48, 85, 86], "float": [0, 2, 3, 4, 11, 12, 13, 16, 20, 22, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46, 47, 48, 65, 69, 71, 75, 76, 78, 91], "proport": [0, 2, 85], "input": [0, 2, 5, 7, 8, 11, 14, 15, 16, 17, 23, 24, 26, 27, 28, 29, 65, 66, 69, 70, 71, 72, 73, 75, 76, 78, 91], "mask": [0, 2], "replac": [0, 2], "valid": [0, 2, 65, 69, 76, 78], "sampl": [0, 2, 5, 7, 12, 13, 18, 19, 20, 22, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 84, 87, 91], "creat": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29], "copi": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29], "befor": [0, 2, 3, 4, 11, 16, 26, 27, 28, 29, 85, 86, 91], "type": [0, 2, 3, 4, 5, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46, 47, 48, 65, 69, 70, 71, 72, 73, 75, 76, 78, 85], "oracl": [3, 47, 48], "sentenceembeddinglearn": 3, "env": [3, 4, 11, 16, 26, 27, 28, 29], "baseencod": [3, 4, 5, 14, 16, 17, 25, 28], "nn": [3, 4, 11, 14, 16, 26, 27, 28, 29, 91], "modul": [3, 4, 11, 16, 26, 27, 28, 29, 84, 87, 92], "semisyntheticdataset": [3, 4, 12, 87, 91], "onlin": [3, 4, 84, 87], "environ": [3, 4, 84, 86, 87], "gener": [3, 4, 5, 9, 11, 12, 13, 18, 19, 20, 21, 22, 25, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 46, 47, 48, 65, 68, 76, 77, 85, 86, 87, 91, 92], "fit_onlin": [3, 4], "10": [3, 4, 5, 8, 14, 17, 25, 26, 29, 47, 48, 85, 91], "alpha": [3, 4], "constant": [3, 4, 85], "multipli": [3, 4], "distanc": [3, 4, 65, 71, 75, 76, 80, 82, 85], "abstract": [5, 7, 8, 9, 10, 11, 87], "function": [5, 11, 12, 13, 16, 26, 27, 28, 29, 65, 76, 85, 86, 91], "encod": [5, 8, 25, 28], "polici": [5, 8, 9, 12, 13, 14, 17, 47, 48, 65, 68, 76, 77, 84, 88, 91, 92], "The": [5, 8, 11, 12, 13, 14, 16, 17, 26, 27, 28, 29, 84, 86, 87, 91, 92], "follow": [5, 7, 8, 11, 12, 13, 16, 26, 27, 28, 29, 47, 48, 65, 68, 76, 77, 84, 85, 86, 87, 88, 91, 92], "should": [5, 8, 11, 16, 25, 26, 27, 28, 29, 84, 85, 91], "specifi": [5, 8, 9, 11, 12, 13, 16, 18, 19, 20, 21, 22, 26, 27, 28, 29, 65, 68, 76, 77, 91], "init": [5, 8, 11, 16, 26, 27, 28, 29], "dim_emb": [5, 8, 14, 16, 17, 25, 26, 29, 91], "dimens": [5, 8, 14, 16, 17, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 69, 76, 78, 86], "context": [5, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 22, 25, 26, 27, 28, 29, 30, 38, 43, 45, 47, 48, 65, 68, 76, 77, 84, 85, 86, 87, 92], "queri": [5, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 65, 68, 76, 77, 86], "128": [5, 8, 14, 16, 17, 18, 19], "low": [5, 8, 14, 16, 17, 91], "dimension": [5, 8, 14, 16, 17, 47, 48, 85, 86, 91], "vector": [5, 7, 8, 14, 16, 17, 20, 22, 30, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 68, 76, 77, 86], "shape": [5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 66, 67, 68, 71, 73, 75, 76, 77, 91], "n_sampl": [5, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48, 65, 66, 67, 68, 71, 73, 75, 76, 77], "text": [5, 8, 14, 16, 17, 85, 86, 91], "prompt": [5, 8, 9, 10, 12, 13, 14, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 29, 47, 48, 65, 68, 76, 77, 84, 85, 86, 87, 88, 92], "tensor": [5, 7, 8, 11, 12, 13, 14, 16, 17, 20, 22, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 65, 67, 68, 69, 71, 72, 75, 76, 77, 78, 91], "dim_context": [5, 8, 12, 13, 14, 16, 17, 20, 22, 25, 27, 28, 30, 38, 43, 45, 47, 48, 65, 68, 76, 77], "each": [5, 7, 8, 9, 11, 12, 13, 14, 16, 18, 19, 20, 22, 26, 27, 28, 29, 30, 38, 47, 48, 65, 68, 76, 77, 84, 85, 86, 87, 91], "requir": [5, 8, 11, 12, 13, 14, 16, 17, 26, 27, 28, 29, 85, 86, 91], "depend": [5, 8, 12, 13, 14, 16, 85, 86], "choic": [5, 8, 12, 13, 47, 48, 85, 86], "dim_sent": [5, 8, 12, 13, 14, 16, 17], "given": [5, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 22, 25, 26, 27, 28, 29, 30, 38, 43, 45, 47, 48, 65, 68, 76, 77, 92], "pca": [5, 8, 14, 17], "matrix": [5, 8, 17, 47, 48], "retriev": [5, 8, 17], "embeddi": [5, 8, 17], "basepromptformatt": [5, 12, 13, 18, 19, 23, 24], "format": [5, 10, 11, 14, 16, 17, 23, 24, 26, 27, 28, 29, 65, 70, 91], "format_token": [5, 10, 14, 17, 23, 24], "basecandidateactionsload": [5, 20, 21], "candid": [5, 6, 12, 13, 20, 21, 30, 32, 40, 47, 48, 85, 86], "action": [5, 6, 12, 13, 20, 21, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 44, 46, 47, 48, 65, 68, 76, 77, 85, 86, 91], "loader": [5, 6, 7, 12, 13], "basecandidateactionload": [5, 6], "basecontextqueryload": [5, 20, 22], "sample_context_and_queri": [5, 7, 20, 22, 30, 38], "exampl": [5, 7, 11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 92], "output": [5, 7, 11, 12, 13, 16, 18, 19, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46, 47, 48, 65, 72, 86, 91], "thi": [5, 7, 11, 12, 13, 16, 18, 19, 25, 26, 27, 28, 29, 47, 48, 84, 85, 86, 87, 91, 92], "fuction": [5, 7, 11], "i": [5, 7, 11, 12, 13, 14, 16, 17, 18, 19, 23, 24, 25, 26, 27, 28, 29, 47, 48, 65, 68, 71, 75, 76, 77, 84, 87, 88, 92], "basefrozenllm": [5, 12, 13, 18, 19, 25, 28, 29], "generate_output_sent": [5, 9, 18, 19], "chosen": [5, 9, 12, 13, 47, 48, 65, 68, 76, 77, 84, 85, 86, 87], "qurei": [5, 9, 18, 19], "discret": [5, 9, 12, 13, 18, 19, 20, 21, 25, 27, 28, 29, 30, 32, 40, 47, 48, 65, 68, 76, 77, 84, 86], "arg": [5, 11, 14, 16, 17, 25, 26, 27, 28, 29, 86], "__call__": [5, 11, 14, 16, 25, 26, 27, 28, 29], "calc_expected_reward": [5, 11, 25, 26, 27, 28, 29, 30, 43, 45], "calcul": [5, 11, 12, 13, 14, 16, 25, 26, 27, 28, 29, 47, 48, 86], "expect": [5, 11, 12, 13, 16, 25, 26, 27, 28, 29, 30, 43, 45, 47, 48, 65, 68, 69, 76, 77, 78, 84, 85, 86, 87], "variabl": [5, 11, 86], "expected_reward": [5, 11, 12, 13, 25, 26, 27, 28, 29, 30, 43, 45, 47, 48, 65, 68, 76, 77], "add_modul": [11, 16, 26, 27, 28, 29], "add": [11, 16, 26, 27, 28, 29], "child": [11, 16, 26, 27, 28, 29], "current": [11, 16, 26, 27, 28, 29, 84, 85, 87], "can": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 88, 91], "access": [11, 16, 26, 27, 28, 29, 86], "ad": [11, 16, 26, 27, 28, 29, 84, 87], "appli": [11, 14, 16, 17, 26, 27, 28, 29, 85, 86, 91], "fn": [11, 16, 26, 27, 28, 29], "recurs": [11, 16, 26, 27, 28, 29], "everi": [11, 16, 26, 27, 28, 29], "submodul": [11, 16, 26, 27, 28, 29], "children": [11, 16, 26, 27, 28, 29], "well": [11, 16, 26, 27, 28, 29, 85], "self": [11, 16, 26, 27, 28, 29], "typic": [11, 16, 26, 27, 28, 29, 85, 86], "includ": [11, 12, 13, 16, 23, 24, 26, 27, 28, 29, 47, 48, 84, 87, 92], "see": [11, 16, 26, 27, 28, 29, 85], "also": [11, 16, 26, 27, 28, 29, 84, 85, 86, 91], "doc": [11, 16, 26, 27, 28, 29], "no_grad": [11, 16, 26, 27, 28, 29], "def": [11, 16, 26, 27, 28, 29], "init_weight": [11, 16, 26, 27, 28, 29], "m": [11, 16, 26, 27, 28, 29, 47, 48, 85, 86], "print": [11, 16, 26, 27, 28, 29], "linear": [11, 16, 26, 27, 28, 29, 84], "fill_": [11, 16, 26, 27, 28, 29], "net": [11, 16, 26, 27, 28, 29], "sequenti": [11, 16, 26, 27, 28, 29], "in_featur": [11, 16, 26, 27, 28, 29], "out_featur": [11, 16, 26, 27, 28, 29], "bia": [11, 16, 26, 27, 28, 29, 30, 36, 42, 85, 86], "true": [11, 12, 13, 16, 25, 26, 27, 28, 29, 85, 91], "contain": [11, 12, 13, 14, 16, 17, 25, 26, 27, 28, 29, 47, 48, 65, 68, 76, 77, 84, 86, 91, 92], "requires_grad": [11, 16, 26, 27, 28, 29], "bfloat16": [11, 16, 26, 27, 28, 29], "cast": [11, 16, 26, 27, 28, 29], "all": [11, 16, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48, 85, 86], "point": [11, 16, 26, 27, 28, 29, 86], "buffer": [11, 16, 26, 27, 28, 29], "datatyp": [11, 16, 26, 27, 28, 29], "modifi": [11, 16, 26, 27, 28, 29], "place": [11, 16, 26, 27, 28, 29], "iter": [11, 16, 26, 27, 28, 29], "over": [11, 16, 26, 27, 28, 29, 85], "yield": [11, 16, 26, 27, 28, 29], "otherwis": [11, 16, 26, 27, 28, 29], "onli": [11, 12, 13, 14, 16, 17, 18, 19, 25, 26, 27, 28, 29, 47, 48, 84, 85, 86, 87], "ar": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 88, 91, 92], "direct": [11, 16, 26, 27, 28, 29, 84, 87, 91], "member": [11, 16, 26, 27, 28, 29], "xdoctest": [11, 16, 26, 27, 28, 29], "skip": [11, 16, 26, 27, 28, 29], "undefin": [11, 16, 26, 27, 28, 29], "var": [11, 16, 26, 27, 28, 29], "buf": [11, 16, 26, 27, 28, 29], "20l": [11, 16, 26, 27, 28, 29], "1l": [11, 16, 26, 27, 28, 29], "5l": [11, 16, 26, 27, 28, 29], "immedi": [11, 16, 26, 27, 28, 29], "compil": [11, 16, 26, 27, 28, 29], "": [11, 12, 13, 16, 26, 27, 28, 29, 85, 86, 92], "forward": [11, 16, 26, 27, 28, 29], "pass": [11, 14, 16, 26, 27, 28, 29], "detail": [11, 16, 26, 27, 28, 29, 84, 85], "cpu": [11, 12, 13, 16, 25, 26, 27, 28, 29], "move": [11, 16, 26, 27, 28, 29], "gpu": [11, 16, 18, 19, 26, 27, 28, 29, 91], "make": [11, 16, 26, 27, 28, 29, 84, 85, 87, 91], "associ": [11, 16, 26, 27, 28, 29, 86], "differ": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 91], "object": [11, 16, 26, 27, 28, 29, 65, 69, 76, 78], "so": [11, 16, 26, 27, 28, 29, 84, 87, 91], "call": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87], "construct": [11, 16, 26, 27, 28, 29], "live": [11, 16, 26, 27, 28, 29], "while": [11, 16, 26, 27, 28, 29, 84, 85, 86, 91], "being": [11, 16, 26, 27, 28, 29, 85, 86], "option": [11, 12, 13, 16, 26, 27, 28, 29], "doubl": [11, 16, 26, 27, 28, 29], "eval": [11, 16, 26, 27, 28, 29], "set": [11, 12, 13, 16, 26, 27, 28, 29, 47, 48, 65, 74, 76, 81, 84, 85, 86, 87], "evalu": [11, 16, 26, 27, 28, 29, 84, 85], "mode": [11, 16, 26, 27, 28, 29], "ha": [11, 16, 26, 27, 28, 29, 86, 91], "ani": [11, 16, 23, 24, 26, 27, 28, 29, 87, 91, 92], "effect": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87], "certain": [11, 16, 26, 27, 28, 29, 85], "document": [11, 16, 26, 27, 28, 29, 83, 84, 91, 92], "particular": [11, 16, 26, 27, 28, 29, 84, 86, 87], "behavior": [11, 16, 26, 27, 28, 29], "thei": [11, 16, 26, 27, 28, 29, 84, 87], "affect": [11, 16, 26, 27, 28, 29, 86], "e": [11, 12, 13, 14, 16, 17, 25, 26, 27, 28, 29, 47, 48, 65, 68, 71, 75, 76, 77, 84, 85, 86, 87, 91, 92], "g": [11, 12, 13, 14, 16, 17, 25, 26, 27, 28, 29, 84, 85, 86, 87, 91], "dropout": [11, 16, 26, 27, 28, 29], "batchnorm": [11, 16, 26, 27, 28, 29], "etc": [11, 12, 13, 16, 26, 27, 28, 29, 47, 48], "equival": [11, 16, 26, 27, 28, 29], "local": [11, 16, 26, 27, 28, 29, 91], "disabl": [11, 16, 26, 27, 28, 29], "grad": [11, 16, 26, 27, 28, 29], "comparison": [11, 16, 26, 27, 28, 29, 87], "between": [11, 16, 25, 26, 27, 28, 29, 30, 38, 65, 71, 75, 84, 85, 86, 87, 91], "sever": [11, 16, 26, 27, 28, 29, 85], "similar": [11, 16, 25, 26, 27, 28, 29, 85, 86], "mechan": [11, 16, 26, 27, 28, 29], "mai": [11, 16, 26, 27, 28, 29, 85, 86], "confus": [11, 16, 26, 27, 28, 29], "extra_repr": [11, 16, 26, 27, 28, 29], "extra": [11, 16, 26, 27, 28, 29], "represent": [11, 16, 26, 27, 28, 29, 84], "To": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 89, 91], "custom": [11, 16, 26, 27, 28, 29], "inform": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 92], "you": [11, 16, 26, 27, 28, 29, 85, 87, 88, 91, 92], "re": [11, 16, 26, 27, 28, 29, 85, 86], "implement": [11, 14, 16, 18, 20, 23, 25, 26, 27, 28, 29, 85, 91, 92], "your": [11, 16, 26, 27, 28, 29, 85, 87, 88, 91, 92], "own": [11, 16, 26, 27, 28, 29, 84], "both": [11, 16, 26, 27, 28, 29, 85, 91], "singl": [11, 16, 26, 27, 28, 29, 85, 86, 91], "line": [11, 16, 26, 27, 28, 29], "multi": [11, 16, 26, 27, 28, 29], "string": [11, 16, 26, 27, 28, 29], "accept": [11, 16, 26, 27, 28, 29], "get_buff": [11, 16, 26, 27, 28, 29], "target": [11, 16, 26, 27, 28, 29, 86], "exist": [11, 16, 26, 27, 28, 29, 84], "throw": [11, 16, 26, 27, 28, 29], "docstr": [11, 16, 26, 27, 28, 29], "get_submodul": [11, 16, 26, 27, 28, 29], "more": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 92], "explan": [11, 16, 26, 27, 28, 29], "how": [11, 16, 26, 27, 28, 29, 85, 87, 91], "correctli": [11, 16, 26, 27, 28, 29], "fulli": [11, 16, 26, 27, 28, 29], "qualifi": [11, 16, 26, 27, 28, 29], "look": [11, 16, 26, 27, 28, 29], "referenc": [11, 16, 26, 27, 28, 29], "rais": [11, 16, 26, 27, 28, 29], "attributeerror": [11, 16, 26, 27, 28, 29], "If": [11, 12, 13, 16, 18, 19, 26, 27, 28, 29, 84, 85, 86, 87, 88, 91, 92], "refer": [11, 16, 26, 27, 28, 29, 85, 86, 87, 88, 91], "invalid": [11, 16, 26, 27, 28, 29], "resolv": [11, 16, 26, 27, 28, 29], "someth": [11, 16, 26, 27, 28, 29], "get_extra_st": [11, 16, 26, 27, 28, 29], "state_dict": [11, 16, 26, 27, 28, 29], "correspond": [11, 12, 13, 16, 26, 27, 28, 29, 65, 70, 76, 79, 84, 86, 91], "set_extra_st": [11, 16, 26, 27, 28, 29], "need": [11, 16, 26, 27, 28, 29, 85, 86], "store": [11, 16, 26, 27, 28, 29], "when": [11, 12, 13, 14, 16, 17, 20, 22, 25, 26, 27, 28, 29, 47, 48, 85, 86, 91], "build": [11, 16, 26, 27, 28, 29], "note": [11, 16, 26, 27, 28, 29, 85, 86, 87, 88, 91, 92], "picklabl": [11, 16, 26, 27, 28, 29], "ensur": [11, 16, 26, 27, 28, 29], "work": [11, 16, 26, 27, 28, 29, 84, 85, 87, 88, 92], "serial": [11, 16, 26, 27, 28, 29], "we": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 91], "provid": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 91, 92], "backward": [11, 16, 26, 27, 28, 29], "compat": [11, 16, 26, 27, 28, 29, 84, 87, 92], "guarante": [11, 16, 26, 27, 28, 29, 85], "other": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87, 91], "break": [11, 16, 26, 27, 28, 29], "pickl": [11, 16, 26, 27, 28, 29], "form": [11, 16, 26, 27, 28, 29, 85], "chang": [11, 16, 26, 27, 28, 29, 85], "get_paramet": [11, 16, 26, 27, 28, 29], "For": [11, 14, 16, 17, 26, 27, 28, 29, 84, 85, 87, 91], "let": [11, 16, 26, 27, 28, 29, 86, 91], "sai": [11, 16, 26, 27, 28, 29], "have": [11, 16, 25, 26, 27, 28, 29, 84, 85, 86, 87, 91, 92], "A": [11, 16, 26, 27, 28, 29, 85, 86, 87], "like": [11, 16, 26, 27, 28, 29, 85, 86], "net_b": [11, 16, 26, 27, 28, 29], "net_c": [11, 16, 26, 27, 28, 29], "conv": [11, 16, 26, 27, 28, 29], "conv2d": [11, 16, 26, 27, 28, 29], "33": [11, 16, 26, 27, 28, 29], "kernel_s": [11, 16, 26, 27, 28, 29], "3": [11, 16, 26, 27, 28, 29, 85, 86, 91], "stride": [11, 16, 26, 27, 28, 29], "200": [11, 16, 26, 27, 28, 29], "diagram": [11, 16, 26, 27, 28, 29], "show": [11, 16, 26, 27, 28, 29], "nest": [11, 16, 26, 27, 28, 29], "which": [11, 14, 16, 17, 23, 24, 26, 27, 28, 29, 65, 68, 76, 77, 84, 85, 86, 87, 91, 92], "itself": [11, 16, 26, 27, 28, 29], "two": [11, 16, 26, 27, 28, 29, 47, 48, 65, 71, 75, 84, 85, 86, 87], "check": [11, 16, 26, 27, 28, 29, 65, 68, 69, 76, 77, 78], "would": [11, 16, 26, 27, 28, 29, 84, 87], "runtim": [11, 16, 26, 27, 28, 29], "bound": [11, 16, 26, 27, 28, 29], "degre": [11, 16, 26, 27, 28, 29], "against": [11, 16, 26, 27, 28, 29], "named_modul": [11, 16, 26, 27, 28, 29], "achiev": [11, 16, 26, 27, 28, 29], "same": [11, 16, 25, 26, 27, 28, 29, 86, 91], "result": [11, 16, 26, 27, 28, 29, 85, 86, 91], "o": [11, 16, 26, 27, 28, 29, 47, 48], "n": [11, 16, 26, 27, 28, 29, 47, 48, 85, 86], "transit": [11, 16, 26, 27, 28, 29], "simpl": [11, 16, 25, 26, 27, 28, 29], "some": [11, 12, 13, 16, 26, 27, 28, 29, 65, 68, 76, 77, 84, 86, 87], "alwai": [11, 16, 26, 27, 28, 29], "abov": [11, 16, 26, 27, 28, 29, 84, 85, 87, 88, 91], "half": [11, 16, 26, 27, 28, 29], "ipu": [11, 16, 26, 27, 28, 29], "load_state_dict": [11, 16, 26, 27, 28, 29], "strict": [11, 16, 26, 27, 28, 29], "assign": [11, 16, 26, 27, 28, 29], "its": [11, 16, 20, 22, 26, 27, 28, 29, 85, 86, 91], "descend": [11, 16, 26, 27, 28, 29], "kei": [11, 12, 13, 16, 26, 27, 28, 29, 47, 48, 65, 68, 76, 77, 85, 86, 87], "must": [11, 12, 13, 16, 26, 27, 28, 29, 85, 86], "exactli": [11, 16, 26, 27, 28, 29], "match": [11, 16, 26, 27, 28, 29], "after": [11, 14, 16, 17, 26, 27, 28, 29], "persist": [11, 16, 26, 27, 28, 29], "strictli": [11, 16, 26, 27, 28, 29], "enforc": [11, 16, 26, 27, 28, 29], "dictionari": [11, 12, 13, 14, 16, 17, 25, 26, 27, 28, 29, 47, 48], "instead": [11, 16, 26, 27, 28, 29, 85, 86, 91], "them": [11, 16, 26, 27, 28, 29, 91], "inplac": [11, 16, 26, 27, 28, 29], "properti": [11, 16, 26, 27, 28, 29, 87], "preserv": [11, 16, 26, 27, 28, 29], "missing_kei": [11, 16, 26, 27, 28, 29], "list": [11, 16, 18, 19, 26, 27, 28, 29, 91], "miss": [11, 16, 26, 27, 28, 29], "unexpected_kei": [11, 16, 26, 27, 28, 29], "unexpect": [11, 16, 26, 27, 28, 29], "namedtupl": [11, 16, 26, 27, 28, 29], "field": [11, 16, 26, 27, 28, 29], "regist": [11, 16, 26, 27, 28, 29], "runtimeerror": [11, 16, 26, 27, 28, 29], "network": [11, 16, 26, 27, 28, 29, 86], "duplic": [11, 16, 26, 27, 28, 29, 91], "onc": [11, 16, 26, 27, 28, 29, 85], "In": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87], "l": [11, 16, 26, 27, 28, 29, 92], "idx": [11, 16, 26, 27, 28, 29], "enumer": [11, 16, 26, 27, 28, 29], "named_buff": [11, 16, 26, 27, 28, 29], "prefix": [11, 14, 16, 17, 26, 27, 28, 29], "remove_dupl": [11, 16, 26, 27, 28, 29], "prepend": [11, 16, 26, 27, 28, 29], "remov": [11, 16, 26, 27, 28, 29, 91], "tupl": [11, 16, 26, 27, 28, 29, 65, 69, 76, 78], "running_var": [11, 16, 26, 27, 28, 29], "named_children": [11, 16, 26, 27, 28, 29], "conv4": [11, 16, 26, 27, 28, 29], "conv5": [11, 16, 26, 27, 28, 29], "memo": [11, 16, 26, 27, 28, 29], "alreadi": [11, 16, 26, 27, 28, 29], "named_paramet": [11, 16, 26, 27, 28, 29], "param": [11, 14, 16, 17, 25, 26, 27, 28, 29, 91], "register_backward_hook": [11, 16, 26, 27, 28, 29], "hook": [11, 16, 26, 27, 28, 29], "deprec": [11, 16, 26, 27, 28, 29], "favor": [11, 16, 26, 27, 28, 29, 85], "register_full_backward_hook": [11, 16, 26, 27, 28, 29], "futur": [11, 16, 26, 27, 28, 29, 84, 85, 87], "version": [11, 16, 26, 27, 28, 29], "handl": [11, 12, 16, 26, 27, 28, 29, 30, 47, 84, 87], "removablehandl": [11, 16, 26, 27, 28, 29], "register_buff": [11, 16, 26, 27, 28, 29], "consid": [11, 16, 26, 27, 28, 29, 84, 85, 86, 87], "running_mean": [11, 16, 26, 27, 28, 29], "part": [11, 16, 26, 27, 28, 29, 47, 48, 87, 88, 92], "alongsid": [11, 16, 26, 27, 28, 29], "non": [11, 16, 26, 27, 28, 29, 85], "latter": [11, 16, 26, 27, 28, 29, 92], "oper": [11, 12, 13, 16, 26, 27, 28, 29, 84, 86, 87, 92], "run": [11, 16, 26, 27, 28, 29, 85, 91], "ignor": [11, 16, 26, 27, 28, 29], "zero": [11, 16, 26, 27, 28, 29], "num_featur": [11, 16, 26, 27, 28, 29], "register_forward_hook": [11, 16, 26, 27, 28, 29], "with_kwarg": [11, 16, 26, 27, 28, 29], "always_cal": [11, 16, 26, 27, 28, 29], "time": [11, 12, 13, 16, 26, 27, 28, 29, 85, 86], "comput": [11, 12, 13, 16, 26, 27, 28, 29, 85], "posit": [11, 16, 26, 27, 28, 29, 91], "keyword": [11, 16, 26, 27, 28, 29], "won": [11, 16, 26, 27, 28, 29], "t": [11, 16, 26, 27, 28, 29], "It": [11, 16, 26, 27, 28, 29, 85], "sinc": [11, 16, 26, 27, 28, 29, 84, 85], "signatur": [11, 16, 26, 27, 28, 29], "possibli": [11, 16, 26, 27, 28, 29], "callabl": [11, 16, 26, 27, 28, 29], "defin": [11, 16, 20, 26, 27, 28, 29, 85, 86], "fire": [11, 16, 26, 27, 28, 29], "global": [11, 16, 26, 27, 28, 29], "register_module_forward_hook": [11, 16, 26, 27, 28, 29], "regardless": [11, 16, 26, 27, 28, 29, 86], "except": [11, 16, 26, 27, 28, 29], "register_forward_pre_hook": [11, 16, 26, 27, 28, 29], "pre": [11, 16, 26, 27, 28, 29, 85, 91], "invok": [11, 16, 26, 27, 28, 29], "either": [11, 12, 13, 16, 26, 27, 28, 29, 47, 48, 65, 68, 76, 77, 86], "valu": [11, 12, 13, 16, 26, 27, 28, 29, 47, 48, 65, 69, 76, 78, 85, 86], "wrap": [11, 16, 26, 27, 28, 29], "unless": [11, 16, 26, 27, 28, 29], "And": [11, 16, 26, 27, 28, 29], "forward_pr": [11, 16, 26, 27, 28, 29], "register_module_forward_pre_hook": [11, 16, 26, 27, 28, 29], "respect": [11, 16, 26, 27, 28, 29, 85], "execut": [11, 16, 26, 27, 28, 29], "grad_input": [11, 16, 26, 27, 28, 29], "grad_output": [11, 16, 26, 27, 28, 29], "new": [11, 16, 26, 27, 28, 29, 84, 86, 87], "subsequ": [11, 16, 26, 27, 28, 29], "entri": [11, 16, 26, 27, 28, 29], "technic": [11, 16, 26, 27, 28, 29], "reason": [11, 16, 26, 27, 28, 29, 86], "receiv": [11, 16, 26, 27, 28, 29], "view": [11, 16, 26, 27, 28, 29], "similarli": [11, 16, 26, 27, 28, 29, 85, 86], "caller": [11, 16, 26, 27, 28, 29], "allow": [11, 16, 26, 27, 28, 29, 65, 69, 76, 78, 84], "register_module_full_backward_hook": [11, 16, 26, 27, 28, 29], "register_full_backward_pre_hook": [11, 16, 26, 27, 28, 29], "backward_pr": [11, 16, 26, 27, 28, 29], "register_module_full_backward_pre_hook": [11, 16, 26, 27, 28, 29], "register_load_state_dict_post_hook": [11, 16, 26, 27, 28, 29], "post": [11, 16, 26, 27, 28, 29], "incompatible_kei": [11, 16, 26, 27, 28, 29], "consist": [11, 14, 16, 17, 26, 27, 28, 29, 84, 91], "perform": [11, 12, 13, 16, 26, 27, 28, 29, 84, 86, 87], "modif": [11, 16, 26, 27, 28, 29], "addit": [11, 16, 26, 27, 28, 29], "thrown": [11, 16, 26, 27, 28, 29], "clear": [11, 16, 26, 27, 28, 29], "out": [11, 16, 26, 27, 28, 29], "avoid": [11, 16, 18, 19, 26, 27, 28, 29, 85, 86], "register_modul": [11, 16, 26, 27, 28, 29], "register_paramet": [11, 16, 26, 27, 28, 29], "register_state_dict_pre_hook": [11, 16, 26, 27, 28, 29], "These": [11, 16, 26, 27, 28, 29, 84, 91], "keep_var": [11, 16, 26, 27, 28, 29], "process": [11, 16, 20, 26, 27, 28, 29, 84, 86, 87], "made": [11, 16, 26, 27, 28, 29], "requires_grad_": [11, 16, 26, 27, 28, 29], "autograd": [11, 16, 26, 27, 28, 29], "record": [11, 12, 13, 16, 26, 27, 28, 29, 47, 48], "help": [11, 16, 26, 27, 28, 29, 85], "freez": [11, 16, 26, 27, 28, 29], "individu": [11, 16, 26, 27, 28, 29, 84, 87], "gan": [11, 16, 26, 27, 28, 29], "found": [11, 16, 26, 27, 28, 29], "share_memori": [11, 16, 26, 27, 28, 29], "share_memory_": [11, 16, 26, 27, 28, 29], "destin": [11, 16, 26, 27, 28, 29], "whole": [11, 14, 16, 17, 23, 24, 26, 27, 28, 29], "averag": [11, 16, 26, 27, 28, 29, 85], "shallow": [11, 16, 26, 27, 28, 29], "order": [11, 16, 26, 27, 28, 29], "howev": [11, 16, 26, 27, 28, 29, 85, 86], "releas": [11, 16, 26, 27, 28, 29, 87], "pleas": [11, 16, 26, 27, 28, 29, 85, 87, 88, 91, 92], "design": [11, 16, 26, 27, 28, 29, 84, 87], "end": [11, 16, 26, 27, 28, 29, 87, 91, 92], "updat": [11, 16, 26, 27, 28, 29], "ordereddict": [11, 16, 26, 27, 28, 29], "compos": [11, 16, 26, 27, 28, 29], "detach": [11, 16, 26, 27, 28, 29], "dtype": [11, 16, 26, 27, 28, 29, 65, 69, 76, 78], "non_block": [11, 16, 26, 27, 28, 29], "memory_format": [11, 16, 26, 27, 28, 29], "channels_last": [11, 16, 26, 27, 28, 29], "Its": [11, 16, 26, 27, 28, 29, 85], "complex": [11, 16, 26, 27, 28, 29, 86], "integr": [11, 16, 26, 27, 28, 29], "unchang": [11, 16, 26, 27, 28, 29], "tri": [11, 16, 26, 27, 28, 29], "convert": [11, 16, 26, 27, 28, 29, 86], "asynchron": [11, 16, 26, 27, 28, 29], "host": [11, 16, 26, 27, 28, 29], "possibl": [11, 16, 26, 27, 28, 29, 85], "pin": [11, 16, 26, 27, 28, 29], "memori": [11, 16, 26, 27, 28, 29, 91], "below": [11, 16, 26, 27, 28, 29, 84, 85, 87, 88, 92], "desir": [11, 16, 26, 27, 28, 29], "whose": [11, 16, 26, 27, 28, 29, 86], "4d": [11, 16, 26, 27, 28, 29], "ignore_w": [11, 16, 26, 27, 28, 29], "determinist": [11, 16, 26, 27, 28, 29], "1913": [11, 16, 26, 27, 28, 29], "3420": [11, 16, 26, 27, 28, 29], "5113": [11, 16, 26, 27, 28, 29], "2325": [11, 16, 26, 27, 28, 29], "float64": [11, 16, 26, 27, 28, 29], "torch_doctest_cuda1": [11, 16, 26, 27, 28, 29], "gpu1": [11, 16, 26, 27, 28, 29], "1914": [11, 16, 26, 27, 28, 29], "5112": [11, 16, 26, 27, 28, 29], "2324": [11, 16, 26, 27, 28, 29], "float16": [11, 16, 26, 27, 28, 29], "cdoubl": [11, 16, 26, 27, 28, 29], "3741": [11, 16, 26, 27, 28, 29], "j": [11, 16, 26, 27, 28, 29, 85], "2382": [11, 16, 26, 27, 28, 29], "5593": [11, 16, 26, 27, 28, 29], "4443": [11, 16, 26, 27, 28, 29], "complex128": [11, 16, 26, 27, 28, 29], "ones": [11, 16, 26, 27, 28, 29], "6122": [11, 16, 26, 27, 28, 29], "1150": [11, 16, 26, 27, 28, 29], "to_empti": [11, 16, 26, 27, 28, 29], "without": [11, 12, 13, 16, 23, 24, 25, 26, 27, 28, 29, 85, 91], "storag": [11, 16, 26, 27, 28, 29], "dst_type": [11, 16, 26, 27, 28, 29], "xpu": [11, 16, 26, 27, 28, 29], "zero_grad": [11, 16, 26, 27, 28, 29], "set_to_non": [11, 16, 26, 27, 28, 29], "reset": [11, 16, 26, 27, 28, 29], "under": [11, 16, 26, 27, 28, 29, 85, 86, 91], "synthet": [12, 30, 84, 85, 87, 91, 92], "context_query_load": [12, 13], "candidate_actions_load": [12, 13], "frozen_llm": [12, 13, 25, 28, 29], "reward_simul": [12, 13, 47, 48], "frozen_llm_prompt_formatt": [12, 13], "path_to_user_embed": [12, 13, 20, 22, 91], "asset": [12, 13, 20, 21, 22, 91], "movielens_transformer_user_embed": [12, 13, 20, 22], "pt": [12, 13, 20, 21, 22, 91], "path_to_queri": [12, 13, 20, 22, 91], "movielens_queri": [12, 13, 20, 22, 91], "csv": [12, 13, 20, 21, 22, 91], "path_to_query_embed": [12, 13, 20, 22, 91], "movielens_query_emb": [12, 13, 91], "path_to_interaction_data": [12, 13, 20, 22, 91], "movielens_preprocessed_data": [12, 13, 91], "path_to_candidate_prompt": [12, 13, 20, 21, 91], "movielens_benchmark_prompt": [12, 13, 20, 21, 91], "path_to_prompt_embed": [12, 13, 20, 21, 91], "movielens_prompt_emb": [12, 13, 91], "path_to_finetuned_param": [12, 13, 91], "movielens_distilbert_reward_simul": [12, 13, 91], "frozen_llm_base_model_id": [12, 13, 91], "mistralai": [12, 13, 14, 17, 91], "mistral": [12, 13, 14, 17, 91], "7b": [12, 13, 14, 17, 91], "instruct": [12, 13, 14, 17, 91], "v0": [12, 13, 14, 17, 91], "frozen_llm_base_tokenizer_id": [12, 13, 91], "frozen_llm_use_tokenizer_fast": [12, 13, 91], "frozen_llm_pattern": [12, 13, 18, 19, 91], "reward_simulator_base_model_id": [12, 13, 91], "distilbert": [12, 13, 25, 29, 91], "uncas": [12, 13, 25, 29, 91], "reward_simulator_base_tokenizer_id": [12, 13, 91], "reward_simulator_use_tokenizer_fast": [12, 13, 91], "reward_typ": [12, 13, 47, 48, 91], "reward_std": [12, 13, 47, 48, 91], "contextqueryload": [12, 13], "candidateactionsload": [12, 13], "determin": [12, 13], "formatt": [12, 13, 18, 19], "collabor": [12, 13, 25, 26, 84, 91], "filter": [12, 13, 25, 26, 84, 91], "file": [12, 13, 20, 21, 22, 91], "vocabulari": [12, 13, 20, 21], "huggingfac": [12, 13, 84, 87, 91, 92], "tokenizerfast": [12, 13], "system": [12, 13, 14, 17, 18, 19, 23, 24, 84, 86, 87, 92], "continu": [12, 13, 47, 48, 65, 68, 76, 77, 85, 91], "standard": [12, 13, 47, 48, 92], "deviat": [12, 13, 47, 48], "sample_dataset": [12, 13, 47, 48], "10000": [12, 13, 25, 29, 47, 48], "is_test": [12, 13, 20, 22], "return_user_id": [12, 13], "return_item_id": [12, 13], "return_context": [12, 13], "return_queri": [12, 13], "return_action_choice_prob": [12, 13, 47, 48], "return_meta_data": [12, 13, 47, 48], "collect": [12, 13, 47, 48, 85, 86, 91, 92], "choos": [12, 13, 47, 48, 65, 68, 76, 77, 84, 86, 87], "index": [12, 13, 47, 48, 85, 86, 91], "1000": [12, 13, 20, 21, 30, 32, 40, 47, 48, 85], "test": [12, 13, 20, 22, 84, 86], "probabl": [12, 13, 47, 48, 85, 86], "meta": [12, 13, 47, 48], "logged_dataset": [12, 13, 47, 48], "action_choice_prob": [12, 13], "logging_polici": [12, 13, 47, 48, 65, 68, 76, 77], "movi": [12, 13, 14, 17, 23, 24, 25, 29, 87, 91, 92], "titl": [12, 13, 14, 17, 25, 29, 85, 87, 88, 91, 92], "predict": [12, 13, 65, 68, 76, 77, 86, 91], "basepolici": [12, 13, 65, 68, 76, 77], "soft": [12, 13, 47, 48, 65, 68, 76, 77, 85, 86], "meta_data": [12, 13, 47, 48], "candidate_prompt": [12, 13], "user_embed": [12, 13, 25, 27, 28], "item_embed": [12, 13], "prompt_embed": [12, 13, 25, 27, 28, 91], "nois": [12, 13, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48, 85], "level": [12, 13, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48], "n_action": [12, 13, 18, 19, 20, 21, 25, 27, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 44, 46, 47, 48, 91], "map": [12, 13, 14, 17, 25, 27, 28, 29, 47, 48, 91], "n_user": [12, 13, 25, 26, 27, 28, 29, 91], "n_item": [12, 13, 25, 26, 27, 29, 91], "dim_queri": [12, 13, 20, 22, 25, 27, 28, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 48], "dim_act": [12, 13, 47, 48, 65, 68, 76, 77], "calc_expected_reward_given_act": [12, 13, 47, 48], "return_cpu_tensor": [12, 13, 25, 26, 27, 28, 29], "sample_reward_given_act": [12, 13, 47, 48], "calc_expected_reward_given_output": [12, 13], "culcul": [12, 13], "content": [12, 13], "sample_reward_given_output": [12, 13, 47, 48], "calc_expected_policy_valu": [12, 13, 47, 48], "n_samples_to_approxim": [12, 13, 47, 48], "baselin": [12, 13, 25, 29, 84, 87], "approxim": [12, 13, 47, 48, 85, 86], "policy_valu": [12, 13], "calc_skyline_policy_valu": [12, 13], "small": [12, 13, 85, 86], "becaus": [12, 13, 85, 86], "take": [12, 13, 85, 86, 91], "batchdataset": 14, "textual": [14, 15], "transformerencod": [14, 16], "base_model": [14, 17, 25, 29], "is_causal_lm": [14, 17], "prefix_prompt": [14, 17, 23, 24], "postfix_prompt": [14, 17, 23, 24], "prefix_tokens_max_length": [14, 17], "postfix_tokens_max_length": [14, 17], "max_length": [14, 17, 25, 29], "20": [14, 16, 17], "transform": [14, 16, 17, 25, 29, 65, 70, 76, 79], "pretrainedmodel": [14, 17, 18, 19, 25, 29], "pretrain": [14, 17], "causal": [14, 17], "lm": [14, 17], "attach": [14, 17, 91], "input_prompt": [14, 17], "length": [14, 17, 18, 19], "longer": [14, 17, 91], "cut": [14, 17, 18, 19], "off": [14, 17, 18, 19, 84, 86, 88, 91], "postfix": [14, 17], "max": [14, 17, 86], "entir": [14, 17], "fit_pca": [14, 17], "fit": [14, 17, 85], "high": [14, 17, 85, 86, 91], "featur": [14, 17, 25, 27, 28, 29, 30, 38, 40, 47, 48, 65, 68, 76, 77, 84, 86, 87, 91], "api": [14, 17, 85, 86, 91], "input_token": [14, 17], "concat_token": [14, 17, 23, 24], "combin": [14, 17, 23, 24, 86], "nnsentenceencod": 14, "base_transformer_encod": [14, 16], "query_encod": [14, 16], "is_context_depend": [14, 16], "hidden_dim": [14, 16, 25, 26, 29], "top": [14, 16, 83, 84], "diment": [14, 16], "hidden": [14, 16, 25, 26, 29], "layer": [14, 16, 25, 26, 29, 91], "mlp": [14, 16, 25, 26, 29], "calc_gradi": [14, 16, 25, 26, 27, 28, 29], "through": [14, 16, 84, 86, 87, 92], "autofrozenllm": 18, "prompt_formatt": [18, 19], "pattern": [18, 19], "recip": [18, 19], "task": [18, 19, 84, 87, 92], "avail": [18, 19, 87, 88, 91, 92], "repeat": [18, 19], "redund": [18, 19], "max_new_token": [18, 19], "30": [18, 19], "maximum": [18, 19, 65, 69, 76, 78], "defaultcandidateactionsload": 20, "defaultcontextqueryload": 20, "test_ratio": [20, 22], "5": [20, 22, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 85, 86, 91], "ratio": [20, 22], "split": [20, 22], "return_query_embed": [20, 22], "query_embed": [20, 22, 25, 27, 28, 91], "movielenspromptformatt": 23, "broadli": [23, 24], "describ": [23, 24, 84, 86], "genr": [23, 24, 91], "specif": [23, 24, 84, 85, 87], "ntitl": [23, 24], "mid_prompt": [23, 24], "nkeyword": [23, 24], "nmovi": [23, 24], "query_token": [23, 24], "prompt_token": [23, 24], "collaborativefilteringrewardsimul": 25, "expeect": [25, 26, 27, 28, 29], "transformerrewardsimul": 25, "baseline_sent": [25, 29], "is_finetun": [25, 27, 28, 29], "calc_skyline_expected_reward": [25, 27, 28, 29], "action_list": [25, 27, 28, 29, 47, 48], "promptcossimrewardsimul": 25, "cosin": [25, 27, 28], "dim_prompt": [25, 27], "sentencecossimrewardsimul": 25, "sentence_encod": [25, 28], "support": [25, 28, 84, 85, 86, 88, 92], "independ": [25, 28, 85, 86], "contextquerygener": 30, "context_query_covari": [30, 38], "covari": [30, 38, 86], "candidateactionsgener": 30, "dim_action_embed": [30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 44, 46, 47, 48], "auxiliaryoutputgener": 30, "dim_auxiliary_output": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46, 47, 48], "query_coefficient_matrix": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46], "action_coefficient_matrix": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46], "noise_level": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46], "auxiliari": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46, 47, 48, 86], "dim_action_embd": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48], "coeffici": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46], "sample_auxiliary_output": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46], "action_embed": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46], "enumerate_act": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46], "auxiliary_output": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 43, 44, 45, 46, 47, 48], "m_sampl": [30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 44, 46], "rewardsimul": [30, 87], "context_coefficient_matrix": [30, 43, 45], "normal": [30, 43, 45], "term": [30, 43, 45, 85], "mixtureofgaussiancandidateactionsgener": 30, "n_cluster": [30, 40], "n_actions_per_clust": [30, 40], "cluster_cent": [30, 40], "gaussian": [30, 40, 65, 71, 76, 80, 85], "distribut": [30, 40, 85, 86], "cluster": [30, 40, 47, 48, 84, 86], "center": [30, 40], "confoundedauxiliaryoutputgener": 30, "dim_confounded_auxiliary_output": [30, 33, 34, 35, 36, 37], "confounder_scal": [30, 33, 34, 35, 36, 37], "confound": [30, 33, 34, 35, 36, 37], "scale": [30, 33, 85], "rationalauxiliaryoutputgener": 30, "sigmoidauxiliaryoutputgener": 30, "max_abs_v": [30, 34, 35, 37, 39, 41, 44, 46], "scaler": [30, 34, 35, 37, 39, 41, 44, 46], "trigonometricauxiliaryoutputgener": 30, "powerauxiliaryoutputgener": 30, "exponentialauxiliaryoutputgener": 30, "confoundedrationalauxiliaryoutputgener": 30, "confoundedtrigonometricauxiliaryoutputgener": 30, "confoundedpowerauxiliaryoutputgener": 30, "confoundedexponentialauxiliaryoutputgener": 30, "sparserewardsimul": 30, "dim_sparse_auxiliary_output": [30, 45], "syntheticdataset": [47, 87], "context_query_gener": [47, 48], "candidate_action_gener": [47, 48], "auxiliary_output_gener": [47, 48], "substitut": [47, 48], "languag": [47, 48, 84, 86, 87, 88, 91, 92], "benchmark": [47, 48, 84, 85, 87, 88, 91, 92], "numer": [47, 48], "x": [47, 48, 85, 86], "d_x": [47, 48], "q": [47, 48, 85, 86], "d_q": [47, 48, 86], "d_a": [47, 48], "d_e": [47, 48, 86], "d_o": [47, 48], "where": [47, 48, 84, 85, 86, 87], "r": [47, 48, 85, 86], "maxtrix": [47, 48], "is_oracle_polici": [47, 48], "is_oracle_clustering_logging_polici": [47, 48], "auiliari": [47, 48], "applic": [47, 48, 84, 85, 86, 87, 91], "n_outputs_to_approxim": [47, 48], "approzim": [47, 48], "calc_expected_reward_for_all_act": [47, 48], "stage": [47, 48, 84, 86, 87], "tool": [65, 76, 84, 87], "frozenllmdataset": 65, "dataset": [65, 66, 67, 84, 85, 92], "src": [65, 66, 67], "rewardsimulatordataset": 65, "sentence_token": [65, 67], "to_devic": 65, "transfer": [65, 72], "gaussian_kernel": [65, 76], "tau": [65, 71, 75, 76, 80, 82, 85, 86], "kernel": [65, 71, 75, 76, 80, 82, 84, 87], "bandwidth": [65, 71, 75, 85, 86], "hyperparamet": [65, 71, 75, 85, 86], "uniform_kernel": [65, 76], "uniform": [65, 75, 76, 82, 85], "torch_se": [65, 76], "pytorch": [65, 74, 76, 81], "defaultdict_to_dict": [65, 76], "dict_": [65, 70, 76, 79], "defaultdict": [65, 70, 76, 79], "check_tensor": [65, 76], "expected_dim": [65, 69, 76, 78], "expected_dtyp": [65, 69, 76, 78], "min_val": [65, 69, 76, 78], "max_val": [65, 69, 76, 78], "minimum": [65, 69, 76, 78], "check_logged_feedback": [65, 76], "logged_feedback": [65, 68, 76, 77], "feedback": [65, 68, 76, 77, 92], "loggeddataset": [65, 68, 76, 77], "propmpt": [65, 68, 76, 77], "prev": [83, 84, 85, 86, 88, 91], "back": [83, 84], "crucial": [84, 87], "interact": [84, 86, 87], "platform": [84, 87], "recommend": [84, 87], "educ": [84, 87], "app": [84, 87], "situat": [84, 85, 87], "wall": [84, 87, 92], "2008": [84, 87, 92], "short": [84, 85, 87, 91], "slogan": [84, 87], "shown": [84, 85, 87], "figur": [84, 85, 87], "sci": [84, 87, 92], "fi": [84, 87, 92], "lover": [84, 87], "focus": [84, 87, 92], "aspect": [84, 86, 87, 92], "gain": [84, 85, 87], "attent": [84, 87], "than": [84, 85, 86, 87, 91, 92], "romanc": [84, 87, 92], "vice": [84, 87], "versa": [84, 87], "Such": [84, 87], "maxim": [84, 86, 87], "busi": [84, 87], "metric": [84, 85, 87], "welfar": [84, 87], "packag": [84, 87, 91], "aim": [84, 86, 87], "learn": [84, 85, 88, 91, 92], "bandit": [84, 85, 86, 87, 88, 91, 92], "workflow": [84, 87, 92], "come": [84, 85, 86, 87, 88, 89, 91], "ii": [84, 87, 88, 92], "observ": [84, 85, 86, 87, 92], "xxx": [84, 85, 87, 88, 91, 92], "illustr": [84, 85, 87], "daili": [84, 87], "natur": [84, 86, 87], "respons": [84, 87], "our": [84, 85, 86, 87, 88, 92], "goal": [84, 86, 87], "better": [84, 87], "guid": [84, 85, 86, 87, 88, 91, 92], "contextu": [84, 86, 87], "facilit": [84, 87], "research": [84, 87], "practic": [84, 85, 86, 87], "repres": [84, 87, 91], "full": [84, 87, 92], "streamlin": [84, 87, 91], "connect": [84, 87, 91], "smooth": [84, 85, 87], "experiment": [84, 87], "realist": [84, 87], "present": [84, 87], "semi": [84, 85, 87, 91], "augment": [84, 85, 86, 87], "http": [84, 87, 88, 91], "grouplen": [84, 87], "org": [84, 87], "remark": [84, 87], "commun": [84, 87], "lack": [84, 87], "satisfi": [84, 85, 86, 87, 91], "four": [84, 87, 91], "qualif": [84, 87], "knowledg": [84, 87], "about": [84, 86, 87], "textit": [84, 86, 87], "among": [84, 85, 86, 87], "learnabl": [84, 87], "enabl": [84, 85, 86, 87, 92], "u": [84, 85, 86, 87, 92], "affin": [84, 87, 91], "prefer": [84, 87], "hope": [84, 87], "cornerston": [84, 87], "real": [84, 87], "world": [84, 87], "distinct": 84, "summar": [84, 85], "advantag": 84, "one": [84, 85, 86], "flexibl": 84, "focu": 84, "mainli": 84, "theree": 84, "bottom": 84, "procedur": [84, 86, 92], "first": [84, 85, 91, 92], "code": [84, 91, 92], "setup": [84, 88], "cf": [84, 91], "rate": [84, 91], "info": 84, "proper": 84, "noun": 84, "contrast": [84, 85, 86], "light": 84, "vectori": [84, 86], "variou": [84, 85], "computation": 84, "effici": [84, 86, 87, 92], "wai": [84, 86], "next": [84, 85, 86, 87, 88, 91, 92], "basic": 84, "epsilon": [84, 87], "greedi": [84, 87], "softmax": [84, 87], "begin": 84, "select": [84, 92], "decid": 84, "final": [84, 86, 91], "main": 84, "As": [84, 85, 86], "subsect": 84, "along": 84, "readi": 84, "compar": [84, 85, 86], "engin": 84, "scenario": [84, 85], "larg": [84, 85, 86], "space": [84, 85, 86], "implemet": 84, "reinforc": [84, 87], "citep": [84, 87], "actor": [84, 87], "critic": [84, 87], "cite": [84, 85, 86, 87, 88, 91, 92], "doubli": [84, 87], "robust": [84, 85, 87], "dr": [84, 85, 87], "potec": [84, 85, 87], "dso": [84, 87, 88, 92], "propos": [84, 85, 87, 88], "correpond": 84, "dm": [84, 87], "offcem": [84, 87], "One": 84, "most": [84, 85], "synthtic": 84, "environemnt": 84, "instanti": 84, "improv": [84, 85], "engag": 84, "librari": [84, 87], "multipl": [84, 85, 91], "easili": [84, 85], "driven": 84, "get": [84, 92], "inspir": 84, "openbanditpipelin": 84, "obp": 84, "scope": 84, "rl": 84, "_": [84, 85, 86, 91], "special": 84, "hugginfac": 84, "cipe": 84, "formul": [84, 87], "quickstart": [84, 86, 87, 88, 91, 92], "start": [86, 92], "mathcal": [85, 86], "subseteq": 86, "mathbb": [85, 86], "d_u": 86, "demograph": 86, "profil": 86, "unknown": 86, "p": [85, 86], "condit": [85, 86], "e_a": 86, "via": [85, 86, 91], "stochast": 86, "p_": [85, 86], "respond": 86, "click": 86, "purchas": 86, "pi": [85, 86], "v": [85, 86], "now": 86, "case": 86, "past": [86, 92], "chatgpt": 86, "therefor": [85, 86], "cannot": 86, "d": [85, 86], "pi_0": [85, 86], "x_i": [85, 86], "a_i": [85, 86], "s_i": [85, 86], "r_i": [85, 86], "sim": [85, 86], "prod_": [85, 86], "difficult": 86, "partial": 86, "particularli": [85, 86], "challeng": [85, 86], "thu": [85, 86, 91], "address": 86, "counterfactu": [85, 86], "shift": [85, 86], "reliabl": 86, "section": [85, 86], "offlineprompt": [86, 88, 91, 92], "success": 86, "person": [85, 86, 87, 88, 91, 92], "introduc": 86, "often": [85, 86], "unbiasedli": 86, "varianc": [85, 86], "nabla_": [85, 86], "theta": [85, 86], "pi_": [85, 86], "denot": 86, "z": 86, "predictor": 86, "hat": [85, 86], "approx": [85, 86], "frac": [85, 86], "sum_": [85, 86], "left": [85, 86], "right": [85, 86], "oftentim": 86, "accur": 86, "relat": [85, 86, 91], "aris": 86, "inaccur": 86, "potenti": [85, 86], "correct": [85, 86], "reweigh": [85, 86], "unbias": [85, 86], "foral": [85, 86], "impli": [85, 86], "produc": [85, 86], "consider": [85, 86], "due": [85, 86], "violat": [85, 86], "defici": [85, 86], "extrem": [85, 86], "hybrid": 86, "approach": [85, 86], "exploit": 86, "benefit": 86, "By": [85, 86, 91], "control": [85, 86], "variat": 86, "reduc": [85, 86], "remain": 86, "reduct": [85, 86], "limit": 86, "suffer": [85, 86], "shortcom": [85, 86], "treat": [85, 86], "discard": [85, 86], "deal": 86, "issu": [86, 87], "decompos": 86, "c": 86, "1st": 86, "2nd": 86, "indic": [85, 86], "shelf": [85, 86], "decomposit": 86, "style": 86, "second": 86, "greedili": 86, "naiv": [85, 86, 91], "leverag": [85, 86], "abl": 86, "pair": 86, "wise": 86, "especi": 86, "good": 86, "hard": 86, "identifi": 86, "rich": [85, 86], "account": [85, 86], "margin": [85, 86], "underbrac": [85, 86], "phi": [85, 86], "w": [85, 86], "neighbor": [85, 86], "densiti": [85, 86], "cdot": [85, 86], "int_": [85, 86], "k": [85, 86], "Then": [86, 91], "techniqu": [85, 86], "biggl": [85, 86], "biggr": [85, 86], "reject": [85, 86], "mont": [85, 86], "carlo": [85, 86], "ell": [85, 86], "f_": [85, 86], "psi": [85, 86], "implicitli": [85, 86], "keep": [85, 86], "aforement": 86, "offlin": [86, 88, 91, 92], "preval": [85, 86], "incur": [85, 86], "seriou": 86, "seen": [85, 86], "discuss": 86, "leq": 86, "do": [85, 86], "empir": 86, "known": 86, "saito2022off": 86, "saito2023off": [86, 87], "aggreg": 86, "directli": [85, 86], "smaller": 86, "skylin": 86, "mc": 86, "parametr": 86, "neural": 86, "adequ": 86, "undesir": 86, "converg": 86, "b": 86, "poorli": 86, "harm": 86, "experi": [86, 87, 91], "even": [85, 86], "caus": 86, "ethic": 86, "deploi": 86, "huge": 86, "cost": 86, "overview": 86, "tabl": 86, "python": [87, 88, 91], "motiv": 87, "opl": [87, 92], "frozenllm": 87, "pipelin": [87, 88, 92], "paper": [85, 87, 88, 91, 92], "haruka": [85, 87, 88, 91, 92], "kiyohara": [85, 87, 88, 91, 92], "daniel": [85, 87, 88, 91, 92], "yime": [85, 87, 88, 91, 92], "cao": [85, 87, 88, 91, 92], "yuta": [85, 87, 88, 91, 92], "saito": [85, 87, 88, 91, 92], "thorsten": [85, 87, 88, 91, 92], "joachim": [85, 87, 88, 91, 92], "suit": [87, 88, 91, 92], "preprint": [87, 88, 91, 92], "soon": [87, 88, 91], "articl": [85, 87, 88, 91, 92], "kiyohara2025offlin": [87, 88, 91, 92], "author": [85, 87, 88, 91, 92], "journal": [85, 87, 88, 91, 92], "page": [85, 87, 88, 91], "year": [85, 87, 88, 91, 92], "2025": [85, 87, 88, 91], "find": [85, 87, 88, 91], "kiyohara2025off": [85, 87, 88, 91], "project": [87, 88, 91, 92], "were": [87, 88], "nsf": [87, 88, 92], "award": [87, 88, 92], "2312865": [87, 88, 92], "oac": [87, 88, 92], "2311521": [87, 88, 92], "funai": [87, 88, 92], "oversea": [87, 88, 92], "scholarship": [87, 88, 92], "question": [87, 92], "feel": [87, 92], "free": [87, 92], "hk844": [87, 92], "cornel": [87, 92], "edu": [87, 92], "welcom": [87, 88], "md": [87, 92], "guidelin": [87, 92], "instal": [87, 91, 92], "why": [87, 92], "varieti": [87, 92], "estim": [85, 87, 92], "problem": [85, 87], "pg": 87, "regress": [85, 87], "konda1999actor": 87, "swaminathan2015batch": 87, "dudik2011doubli": 87, "saito2024potec": 87, "kiyohara2024prompt": 87, "beygelzimer2009offset": 87, "invers": [85, 87], "propens": [85, 87], "score": [85, 87], "ip": 87, "strehl2010learn": 87, "evalut": 87, "sutton2018reinforc": 87, "deng2022rlprompt": 87, "github": [87, 88, 92], "licens": 87, "proceed": 87, "pypi": 88, "pip": 88, "git": 88, "clone": 88, "com": [88, 92], "aiueola": 88, "cd": 88, "py": [88, 91], "op": [85, 92], "explor": 92, "modular": 92, "deploy": 92, "smoothli": 92, "citat": 92, "arxiv": 92, "xxxxx": 92, "2023": 92, "wa": 92, "join": 92, "contribut": [85, 92], "repositori": [91, 92], "googl": 92, "group": 92, "googlegroup": 92, "contact": 92, "appraoch": 85, "notat": 85, "calx": [], "cala": [], "here": [85, 91], "idea": 85, "parameter": 85, "conceptu": 85, "write": 85, "concern": 85, "sparsiti": 85, "further": 85, "magnitud": 85, "intuit": 85, "behind": 85, "propto": 85, "exp": 85, "piecewis": 85, "threshold": 85, "equal": 85, "induc": 85, "scalabl": 85, "regard": 85, "moreov": 85, "express": 85, "though": 85, "origin": [85, 91], "implicit": 85, "suggest": 85, "doe": 85, "suffic": 85, "s_j": 85, "qquad": [], "omit": 85, "analysi": 85, "takeawai": 85, "proof": 85, "relax": 85, "assumpt": 85, "theoret": 87, "domin": 85, "factor": 85, "becom": 85, "togeth": 85, "plai": 85, "role": 85, "trade": 85, "overlap": 85, "later": 85, "studi": 87, "vari": 85, "demonstr": 85, "benefici": 85, "simultan": 85, "tradeoff": 85, "math": [], "configur": 85, "500": 85, "2000": 85, "4000": 85, "underlin": 85, "8000": 85, "vanilla": 87, "50": 85, "sigma_": 85, "textbf": [], "unif": 85, "opt": 85, "interest": 85, "sigma_r": 85, "emploi": 85, "fall": 85, "sharp": 85, "drop": 85, "geq": 85, "maintain": 85, "outperform": 85, "far": 85, "4": [85, 91], "report": 85, "tell": 85, "evid": 85, "fact": 85, "alloc": 85, "larger": 85, "closer": 85, "care": 85, "neglig": 85, "1e": 85, "too": 85, "much": 85, "signific": 85, "precis": 85, "inde": 85, "extens": 85, "substanti": 85, "conduct": 85, "built": 85, "10m": [85, 91], "resili": 85, "corrupt": 85, "5x": 85, "increas": 85, "worth": 85, "minim": 85, "difficulti": 85, "ablat": 87, "mathrm": 85, "middl": [], "explain": 91, "sure": 91, "locat": 91, "movielens_naive_cf_user_embed": 91, "movielens_prompt_pca_matrix": 91, "movielens_query_pca_matrix": 91, "movielens_sentence_pca_matrix": 91, "off_prompt": 91, "path_to_directori": 91, "12345": 91, "obtain": 91, "script": 91, "exect": 91, "confirm": 91, "64gb": 91, "download": 91, "preprocess_movielens_dataset_for_reward_simul": 91, "dataset_nam": 91, "dataset_dir": 91, "path_to_movielens_dataset_directori": 91, "binar": 91, "neg": 91, "less": 91, "label": 91, "resampl": 91, "command": 91, "model_id": 91, "tokenizer_id": 91, "those": 91, "beauti": 91, "soup": 91, "readthedoc": 91, "io": 91, "en": 91, "latest": 91, "scraping_prompt": 91, "cultur": 91, "word": 91, "relatedword": 91, "finetuning_reward_simul": 91, "reward_model": 91, "dataset_path": 91, "addition": 91, "movielens_naive_cf_param": 91, "based_model_id": 91, "model_nam": 91, "base_model_id": 91, "movielens_": 91, "_reward_simul": 91, "iv": 91, "uniqu": 91, "bash": 91, "preprocess_movielens_dataset_for_user_query_simul": 91, "user_query_simul": 91, "model_path": 91, "use_naive_cf_user_emb": 91, "preprocess_movielens_dataset_with_embed": 91, "query_path": 91, "prompt_path": 91, "sentence_path": 91, "simualtor": 91, "again": 91, "vocab": 91, "framework": 91, "user_id_embed": 91, "dim_user_emb": 91, "dim_query_emb": 91, "dim_prompt_emb": 91, "_pca_matrix": 91, "last": 91, "dim_frozen_llm_emb": 91, "compon": 91, "sentence_embedding_lay": 91, "user_embedding_lay": 91, "nn_layer": 91, "logit": 91, "path_to_custom_dataset": 91, "_distilbert_reward_simul": 91, "resourc": 91}, "objects": {"off_prompts.dataset.assets": [[0, 0, 0, "-", "reward_finetuner"], [3, 0, 0, "-", "sentence_embedding_learner"]], "off_prompts.dataset.assets.reward_finetuner": [[1, 1, 1, "", "MovielensDataset"], [2, 1, 1, "", "RewardFinetuner"]], "off_prompts.dataset.assets.reward_finetuner.RewardFinetuner": [[2, 2, 1, "", "finetune_model"], [2, 2, 1, "", "init_with_reference_model"], [2, 2, 1, "", "load"], [2, 3, 1, "", "optimizer"], [2, 2, 1, "", "save"], [2, 2, 1, "", "seed"]], "off_prompts.dataset.assets.sentence_embedding_learner": [[4, 1, 1, "", "SentenceEmbeddingLearner"]], "off_prompts.dataset.assets.sentence_embedding_learner.SentenceEmbeddingLearner": [[4, 2, 1, "", "fit_online"], [4, 2, 1, "", "load"], [4, 3, 1, "", "optimizer"], [4, 2, 1, "", "save"], [4, 2, 1, "", "seed"]], "off_prompts.dataset": [[5, 0, 0, "-", "base"], [12, 0, 0, "-", "benchmark"], [14, 0, 0, "-", "encoder"], [18, 0, 0, "-", "frozen_llm"], [20, 0, 0, "-", "function"], [23, 0, 0, "-", "prompt_formatter"], [25, 0, 0, "-", "reward_simulator"]], "off_prompts.dataset.base": [[6, 1, 1, "", "BaseCandidateActionsLoader"], [7, 1, 1, "", "BaseContextQueryLoader"], [8, 1, 1, "", "BaseEncoder"], [9, 1, 1, "", "BaseFrozenLLM"], [10, 1, 1, "", "BasePromptFormatter"], [11, 1, 1, "", "BaseRewardSimulator"]], "off_prompts.dataset.base.BaseContextQueryLoader": [[7, 2, 1, "", "sample_context_and_query"]], "off_prompts.dataset.base.BaseEncoder": [[8, 2, 1, "", "encode"], [8, 2, 1, "", "load"], [8, 2, 1, "", "save"]], "off_prompts.dataset.base.BaseFrozenLLM": [[9, 2, 1, "", "generate_output_sentence"]], "off_prompts.dataset.base.BasePromptFormatter": [[10, 2, 1, "", "format_tokens"]], "off_prompts.dataset.base.BaseRewardSimulator": [[11, 2, 1, "", "add_module"], [11, 2, 1, "", "apply"], [11, 2, 1, "", "bfloat16"], [11, 2, 1, "", "buffers"], [11, 2, 1, "", "calc_expected_reward"], [11, 2, 1, "", "children"], [11, 2, 1, "", "compile"], [11, 2, 1, "", "cpu"], [11, 2, 1, "", "cuda"], [11, 2, 1, "", "double"], [11, 2, 1, "", "eval"], [11, 2, 1, "", "extra_repr"], [11, 2, 1, "", "float"], [11, 2, 1, "", "get_buffer"], [11, 2, 1, "", "get_extra_state"], [11, 2, 1, "", "get_parameter"], [11, 2, 1, "", "get_submodule"], [11, 2, 1, "", "half"], [11, 2, 1, "", "ipu"], [11, 2, 1, "", "load_state_dict"], [11, 2, 1, "", "modules"], [11, 2, 1, "", "named_buffers"], [11, 2, 1, "", "named_children"], [11, 2, 1, "", "named_modules"], [11, 2, 1, "", "named_parameters"], [11, 2, 1, "", "parameters"], [11, 2, 1, "", "register_backward_hook"], [11, 2, 1, "", "register_buffer"], [11, 2, 1, "", "register_forward_hook"], [11, 2, 1, "", "register_forward_pre_hook"], [11, 2, 1, "", "register_full_backward_hook"], [11, 2, 1, "", "register_full_backward_pre_hook"], [11, 2, 1, "", "register_load_state_dict_post_hook"], [11, 2, 1, "", "register_module"], [11, 2, 1, "", "register_parameter"], [11, 2, 1, "", "register_state_dict_pre_hook"], [11, 2, 1, "", "requires_grad_"], [11, 2, 1, "", "set_extra_state"], [11, 2, 1, "", "share_memory"], [11, 2, 1, "", "state_dict"], [11, 2, 1, "", "to"], [11, 2, 1, "", "to_empty"], [11, 2, 1, "", "train"], [11, 2, 1, "", "type"], [11, 2, 1, "", "xpu"], [11, 2, 1, "", "zero_grad"]], "off_prompts.dataset.benchmark": [[13, 1, 1, "", "SemiSyntheticDataset"]], "off_prompts.dataset.benchmark.SemiSyntheticDataset": [[13, 2, 1, "", "calc_expected_policy_value"], [13, 2, 1, "", "calc_expected_reward_given_action"], [13, 2, 1, "", "calc_expected_reward_given_output"], [13, 2, 1, "", "calc_skyline_policy_value"], [13, 2, 1, "", "sample_dataset"], [13, 2, 1, "", "sample_reward_given_action"], [13, 2, 1, "", "sample_reward_given_output"]], "off_prompts.dataset.encoder": [[15, 1, 1, "", "BatchDataset"], [16, 1, 1, "", "NNSentenceEncoder"], [17, 1, 1, "", "TransformerEncoder"]], "off_prompts.dataset.encoder.NNSentenceEncoder": [[16, 2, 1, "", "add_module"], [16, 2, 1, "", "apply"], [16, 2, 1, "", "bfloat16"], [16, 2, 1, "", "buffers"], [16, 2, 1, "", "children"], [16, 2, 1, "", "compile"], [16, 2, 1, "", "cpu"], [16, 2, 1, "", "cuda"], [16, 2, 1, "", "double"], [16, 2, 1, "", "encode"], [16, 2, 1, "", "eval"], [16, 2, 1, "", "extra_repr"], [16, 2, 1, "", "float"], [16, 2, 1, "", "get_buffer"], [16, 2, 1, "", "get_extra_state"], [16, 2, 1, "", "get_parameter"], [16, 2, 1, "", "get_submodule"], [16, 2, 1, "", "half"], [16, 2, 1, "", "ipu"], [16, 2, 1, "", "load"], [16, 2, 1, "", "load_state_dict"], [16, 2, 1, "", "modules"], [16, 2, 1, "", "named_buffers"], [16, 2, 1, "", "named_children"], [16, 2, 1, "", "named_modules"], [16, 2, 1, "", "named_parameters"], [16, 2, 1, "", "parameters"], [16, 2, 1, "", "register_backward_hook"], [16, 2, 1, "", "register_buffer"], [16, 2, 1, "", "register_forward_hook"], [16, 2, 1, "", "register_forward_pre_hook"], [16, 2, 1, "", "register_full_backward_hook"], [16, 2, 1, "", "register_full_backward_pre_hook"], [16, 2, 1, "", "register_load_state_dict_post_hook"], [16, 2, 1, "", "register_module"], [16, 2, 1, "", "register_parameter"], [16, 2, 1, "", "register_state_dict_pre_hook"], [16, 2, 1, "", "requires_grad_"], [16, 2, 1, "", "save"], [16, 2, 1, "", "set_extra_state"], [16, 2, 1, "", "share_memory"], [16, 2, 1, "", "state_dict"], [16, 2, 1, "", "to"], [16, 2, 1, "", "to_empty"], [16, 2, 1, "", "train"], [16, 2, 1, "", "type"], [16, 2, 1, "", "xpu"], [16, 2, 1, "", "zero_grad"]], "off_prompts.dataset.encoder.TransformerEncoder": [[17, 2, 1, "", "encode"], [17, 2, 1, "", "fit_pca"], [17, 2, 1, "", "format_tokens"], [17, 2, 1, "", "load"], [17, 2, 1, "", "save"]], "off_prompts.dataset.frozen_llm": [[19, 1, 1, "", "AutoFrozenLLM"]], "off_prompts.dataset.frozen_llm.AutoFrozenLLM": [[19, 2, 1, "", "generate_output_sentence"]], "off_prompts.dataset.function": [[21, 1, 1, "", "DefaultCandidateActionsLoader"], [22, 1, 1, "", "DefaultContextQueryLoader"]], "off_prompts.dataset.function.DefaultContextQueryLoader": [[22, 2, 1, "", "sample_context_and_query"]], "off_prompts.dataset.prompt_formatter": [[24, 1, 1, "", "MovielensPromptFormatter"]], "off_prompts.dataset.prompt_formatter.MovielensPromptFormatter": [[24, 2, 1, "", "format_tokens"]], "off_prompts.dataset.reward_simulator": [[26, 1, 1, "", "CollaborativeFilteringRewardSimulator"], [27, 1, 1, "", "PromptCossimRewardSimulator"], [28, 1, 1, "", "SentenceCossimRewardSimulator"], [29, 1, 1, "", "TransformerRewardSimulator"]], "off_prompts.dataset.reward_simulator.CollaborativeFilteringRewardSimulator": [[26, 2, 1, "", "add_module"], [26, 2, 1, "", "apply"], [26, 2, 1, "", "bfloat16"], [26, 2, 1, "", "buffers"], [26, 2, 1, "", "calc_expected_reward"], [26, 2, 1, "", "children"], [26, 2, 1, "", "compile"], [26, 2, 1, "", "cpu"], [26, 2, 1, "", "cuda"], [26, 2, 1, "", "double"], [26, 2, 1, "", "eval"], [26, 2, 1, "", "extra_repr"], [26, 2, 1, "", "float"], [26, 2, 1, "", "get_buffer"], [26, 2, 1, "", "get_extra_state"], [26, 2, 1, "", "get_parameter"], [26, 2, 1, "", "get_submodule"], [26, 2, 1, "", "half"], [26, 2, 1, "", "ipu"], [26, 2, 1, "", "load_state_dict"], [26, 2, 1, "", "modules"], [26, 2, 1, "", "named_buffers"], [26, 2, 1, "", "named_children"], [26, 2, 1, "", "named_modules"], [26, 2, 1, "", "named_parameters"], [26, 2, 1, "", "parameters"], [26, 2, 1, "", "register_backward_hook"], [26, 2, 1, "", "register_buffer"], [26, 2, 1, "", "register_forward_hook"], [26, 2, 1, "", "register_forward_pre_hook"], [26, 2, 1, "", "register_full_backward_hook"], [26, 2, 1, "", "register_full_backward_pre_hook"], [26, 2, 1, "", "register_load_state_dict_post_hook"], [26, 2, 1, "", "register_module"], [26, 2, 1, "", "register_parameter"], [26, 2, 1, "", "register_state_dict_pre_hook"], [26, 2, 1, "", "requires_grad_"], [26, 2, 1, "", "set_extra_state"], [26, 2, 1, "", "share_memory"], [26, 2, 1, "", "state_dict"], [26, 2, 1, "", "to"], [26, 2, 1, "", "to_empty"], [26, 2, 1, "", "train"], [26, 2, 1, "", "type"], [26, 2, 1, "", "xpu"], [26, 2, 1, "", "zero_grad"]], "off_prompts.dataset.reward_simulator.PromptCossimRewardSimulator": [[27, 2, 1, "", "add_module"], [27, 2, 1, "", "apply"], [27, 2, 1, "", "bfloat16"], [27, 2, 1, "", "buffers"], [27, 2, 1, "", "calc_expected_reward"], [27, 2, 1, "", "calc_skyline_expected_reward"], [27, 2, 1, "", "children"], [27, 2, 1, "", "compile"], [27, 2, 1, "", "cpu"], [27, 2, 1, "", "cuda"], [27, 2, 1, "", "double"], [27, 2, 1, "", "eval"], [27, 2, 1, "", "extra_repr"], [27, 2, 1, "", "float"], [27, 2, 1, "", "get_buffer"], [27, 2, 1, "", "get_extra_state"], [27, 2, 1, "", "get_parameter"], [27, 2, 1, "", "get_submodule"], [27, 2, 1, "", "half"], [27, 2, 1, "", "ipu"], [27, 2, 1, "", "load_state_dict"], [27, 2, 1, "", "modules"], [27, 2, 1, "", "named_buffers"], [27, 2, 1, "", "named_children"], [27, 2, 1, "", "named_modules"], [27, 2, 1, "", "named_parameters"], [27, 2, 1, "", "parameters"], [27, 2, 1, "", "register_backward_hook"], [27, 2, 1, "", "register_buffer"], [27, 2, 1, "", "register_forward_hook"], [27, 2, 1, "", "register_forward_pre_hook"], [27, 2, 1, "", "register_full_backward_hook"], [27, 2, 1, "", "register_full_backward_pre_hook"], [27, 2, 1, "", "register_load_state_dict_post_hook"], [27, 2, 1, "", "register_module"], [27, 2, 1, "", "register_parameter"], [27, 2, 1, "", "register_state_dict_pre_hook"], [27, 2, 1, "", "requires_grad_"], [27, 2, 1, "", "set_extra_state"], [27, 2, 1, "", "share_memory"], [27, 2, 1, "", "state_dict"], [27, 2, 1, "", "to"], [27, 2, 1, "", "to_empty"], [27, 2, 1, "", "train"], [27, 2, 1, "", "type"], [27, 2, 1, "", "xpu"], [27, 2, 1, "", "zero_grad"]], "off_prompts.dataset.reward_simulator.SentenceCossimRewardSimulator": [[28, 2, 1, "", "add_module"], [28, 2, 1, "", "apply"], [28, 2, 1, "", "bfloat16"], [28, 2, 1, "", "buffers"], [28, 2, 1, "", "calc_expected_reward"], [28, 2, 1, "", "calc_skyline_expected_reward"], [28, 2, 1, "", "children"], [28, 2, 1, "", "compile"], [28, 2, 1, "", "cpu"], [28, 2, 1, "", "cuda"], [28, 2, 1, "", "double"], [28, 2, 1, "", "eval"], [28, 2, 1, "", "extra_repr"], [28, 2, 1, "", "float"], [28, 2, 1, "", "get_buffer"], [28, 2, 1, "", "get_extra_state"], [28, 2, 1, "", "get_parameter"], [28, 2, 1, "", "get_submodule"], [28, 2, 1, "", "half"], [28, 2, 1, "", "ipu"], [28, 2, 1, "", "load_state_dict"], [28, 2, 1, "", "modules"], [28, 2, 1, "", "named_buffers"], [28, 2, 1, "", "named_children"], [28, 2, 1, "", "named_modules"], [28, 2, 1, "", "named_parameters"], [28, 2, 1, "", "parameters"], [28, 2, 1, "", "register_backward_hook"], [28, 2, 1, "", "register_buffer"], [28, 2, 1, "", "register_forward_hook"], [28, 2, 1, "", "register_forward_pre_hook"], [28, 2, 1, "", "register_full_backward_hook"], [28, 2, 1, "", "register_full_backward_pre_hook"], [28, 2, 1, "", "register_load_state_dict_post_hook"], [28, 2, 1, "", "register_module"], [28, 2, 1, "", "register_parameter"], [28, 2, 1, "", "register_state_dict_pre_hook"], [28, 2, 1, "", "requires_grad_"], [28, 2, 1, "", "set_extra_state"], [28, 2, 1, "", "share_memory"], [28, 2, 1, "", "state_dict"], [28, 2, 1, "", "to"], [28, 2, 1, "", "to_empty"], [28, 2, 1, "", "train"], [28, 2, 1, "", "type"], [28, 2, 1, "", "xpu"], [28, 2, 1, "", "zero_grad"]], "off_prompts.dataset.reward_simulator.TransformerRewardSimulator": [[29, 2, 1, "", "add_module"], [29, 2, 1, "", "apply"], [29, 2, 1, "", "bfloat16"], [29, 2, 1, "", "buffers"], [29, 2, 1, "", "calc_expected_reward"], [29, 2, 1, "", "calc_skyline_expected_reward"], [29, 2, 1, "", "children"], [29, 2, 1, "", "compile"], [29, 2, 1, "", "cpu"], [29, 2, 1, "", "cuda"], [29, 2, 1, "", "double"], [29, 2, 1, "", "eval"], [29, 2, 1, "", "extra_repr"], [29, 2, 1, "", "float"], [29, 2, 1, "", "get_buffer"], [29, 2, 1, "", "get_extra_state"], [29, 2, 1, "", "get_parameter"], [29, 2, 1, "", "get_submodule"], [29, 2, 1, "", "half"], [29, 2, 1, "", "ipu"], [29, 2, 1, "", "load_state_dict"], [29, 2, 1, "", "modules"], [29, 2, 1, "", "named_buffers"], [29, 2, 1, "", "named_children"], [29, 2, 1, "", "named_modules"], [29, 2, 1, "", "named_parameters"], [29, 2, 1, "", "parameters"], [29, 2, 1, "", "register_backward_hook"], [29, 2, 1, "", "register_buffer"], [29, 2, 1, "", "register_forward_hook"], [29, 2, 1, "", "register_forward_pre_hook"], [29, 2, 1, "", "register_full_backward_hook"], [29, 2, 1, "", "register_full_backward_pre_hook"], [29, 2, 1, "", "register_load_state_dict_post_hook"], [29, 2, 1, "", "register_module"], [29, 2, 1, "", "register_parameter"], [29, 2, 1, "", "register_state_dict_pre_hook"], [29, 2, 1, "", "requires_grad_"], [29, 2, 1, "", "set_extra_state"], [29, 2, 1, "", "share_memory"], [29, 2, 1, "", "state_dict"], [29, 2, 1, "", "to"], [29, 2, 1, "", "to_empty"], [29, 2, 1, "", "train"], [29, 2, 1, "", "type"], [29, 2, 1, "", "xpu"], [29, 2, 1, "", "zero_grad"]], "off_prompts": [[65, 0, 0, "-", "utils"]], "off_prompts.utils": [[66, 1, 1, "", "FrozenLLMDataset"], [67, 1, 1, "", "RewardSimulatorDataset"], [68, 4, 1, "", "check_logged_feedback"], [69, 4, 1, "", "check_tensor"], [70, 4, 1, "", "defaultdict_to_dict"], [71, 4, 1, "", "gaussian_kernel"], [72, 4, 1, "", "to_device"], [73, 4, 1, "", "tokenize"], [74, 4, 1, "", "torch_seed"], [75, 4, 1, "", "uniform_kernel"]], "off_prompts_syn.dataset": [[30, 0, 0, "-", "function"], [47, 0, 0, "-", "synthetic"]], "off_prompts_syn.dataset.function": [[31, 1, 1, "", "AuxiliaryOutputGenerator"], [32, 1, 1, "", "CandidateActionsGenerator"], [33, 1, 1, "", "ConfoundedAuxiliaryOutputGenerator"], [34, 1, 1, "", "ConfoundedExponentialAuxiliaryOutputGenerator"], [35, 1, 1, "", "ConfoundedPowerAuxiliaryOutputGenerator"], [36, 1, 1, "", "ConfoundedRationalAuxiliaryOutputGenerator"], [37, 1, 1, "", "ConfoundedTrigonometricAuxiliaryOutputGenerator"], [38, 1, 1, "", "ContextQueryGenerator"], [39, 1, 1, "", "ExponentialAuxiliaryOutputGenerator"], [40, 1, 1, "", "MixtureOfGaussianCandidateActionsGenerator"], [41, 1, 1, "", "PowerAuxiliaryOutputGenerator"], [42, 1, 1, "", "RationalAuxiliaryOutputGenerator"], [43, 1, 1, "", "RewardSimulator"], [44, 1, 1, "", "SigmoidAuxiliaryOutputGenerator"], [45, 1, 1, "", "SparseRewardSimulator"], [46, 1, 1, "", "TrigonometricAuxiliaryOutputGenerator"]], "off_prompts_syn.dataset.function.AuxiliaryOutputGenerator": [[31, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.ConfoundedAuxiliaryOutputGenerator": [[33, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.ConfoundedExponentialAuxiliaryOutputGenerator": [[34, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.ConfoundedPowerAuxiliaryOutputGenerator": [[35, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.ConfoundedRationalAuxiliaryOutputGenerator": [[36, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.ConfoundedTrigonometricAuxiliaryOutputGenerator": [[37, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.ContextQueryGenerator": [[38, 2, 1, "", "sample_context_and_query"]], "off_prompts_syn.dataset.function.ExponentialAuxiliaryOutputGenerator": [[39, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.PowerAuxiliaryOutputGenerator": [[41, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.RationalAuxiliaryOutputGenerator": [[42, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.RewardSimulator": [[43, 2, 1, "", "calc_expected_reward"]], "off_prompts_syn.dataset.function.SigmoidAuxiliaryOutputGenerator": [[44, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.function.SparseRewardSimulator": [[45, 2, 1, "", "calc_expected_reward"]], "off_prompts_syn.dataset.function.TrigonometricAuxiliaryOutputGenerator": [[46, 2, 1, "", "sample_auxiliary_output"]], "off_prompts_syn.dataset.synthetic": [[48, 1, 1, "", "SyntheticDataset"]], "off_prompts_syn.dataset.synthetic.SyntheticDataset": [[48, 2, 1, "", "calc_expected_policy_value"], [48, 2, 1, "", "calc_expected_reward_for_all_actions"], [48, 2, 1, "", "calc_expected_reward_given_action"], [48, 2, 1, "", "sample_dataset"], [48, 2, 1, "", "sample_reward_given_action"], [48, 2, 1, "", "sample_reward_given_output"]], "off_prompts_syn": [[76, 0, 0, "-", "utils"]], "off_prompts_syn.utils": [[77, 4, 1, "", "check_logged_feedback"], [78, 4, 1, "", "check_tensor"], [79, 4, 1, "", "defaultdict_to_dict"], [80, 4, 1, "", "gaussian_kernel"], [81, 4, 1, "", "torch_seed"], [82, 4, 1, "", "uniform_kernel"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"]}, "titleterms": {"off_prompt": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 49, 50, 51, 52, 53, 54, 59, 60, 61, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75], "dataset": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 50, 83, 87, 91], "asset": [0, 1, 2, 3, 4], "reward_finetun": [0, 1, 2], "movielensdataset": 1, "rewardfinetun": 2, "sentence_embedding_learn": [3, 4], "sentenceembeddinglearn": 4, "base": [5, 6, 7, 8, 9, 10, 11, 59, 62, 84], "basecandidateactionsload": 6, "basecontextqueryload": 7, "baseencod": 8, "basefrozenllm": 9, "basepromptformatt": 10, "baserewardsimul": 11, "benchmark": [12, 13, 83], "semisyntheticdataset": 13, "encod": [14, 15, 16, 17, 91], "batchdataset": 15, "nnsentenceencod": 16, "transformerencod": 17, "frozen_llm": [18, 19], "autofrozenllm": 19, "function": [20, 21, 22, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46], "defaultcandidateactionsload": 21, "defaultcontextqueryload": 22, "prompt_formatt": [23, 24], "movielenspromptformatt": 24, "reward_simul": [25, 26, 27, 28, 29], "collaborativefilteringrewardsimul": 26, "promptcossimrewardsimul": 27, "sentencecossimrewardsimul": 28, "transformerrewardsimul": 29, "off_prompts_syn": [30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 55, 56, 57, 58, 62, 63, 64, 76, 77, 78, 79, 80, 81, 82], "auxiliaryoutputgener": 31, "candidateactionsgener": 32, "confoundedauxiliaryoutputgener": 33, "confoundedexponentialauxiliaryoutputgener": 34, "confoundedpowerauxiliaryoutputgener": 35, "confoundedrationalauxiliaryoutputgener": 36, "confoundedtrigonometricauxiliaryoutputgener": 37, "contextquerygener": 38, "exponentialauxiliaryoutputgener": 39, "mixtureofgaussiancandidateactionsgener": 40, "powerauxiliaryoutputgener": 41, "rationalauxiliaryoutputgener": 42, "rewardsimul": 43, "sigmoidauxiliaryoutputgener": 44, "sparserewardsimul": 45, "trigonometricauxiliaryoutputgener": 46, "synthet": [47, 48, 83], "syntheticdataset": 48, "opl": [49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 84, 85, 86], "behavior_clon": [49, 55], "marginal_learn": [51, 56], "policy_evalu": 52, "policy_learn": [53, 57], "reward_learn": [54, 58], "polici": [59, 60, 61, 62, 63, 64, 83, 85, 86, 87], "model": [60, 63], "util": [65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82], "frozenllmdataset": 66, "rewardsimulatordataset": 67, "check_logged_feedback": [68, 77], "check_tensor": [69, 78], "defaultdict_to_dict": [70, 79], "gaussian_kernel": [71, 80], "to_devic": 72, "token": 73, "torch_se": [74, 81], "uniform_kernel": [75, 82], "offlineprompt": [83, 84, 87], "packag": 83, "refer": 83, "full": [83, 85, 91], "llm": [83, 84, 85, 91], "modul": 83, "op": [83, 84, 86, 87], "l": [83, 84, 86, 87], "other": 83, "simul": [83, 87, 91], "why": 84, "motiv": 84, "kei": 84, "contribut": [84, 87], "end": 84, "implement": [84, 86, 87], "data": [84, 85, 87, 91], "collect": [84, 87], "gener": 84, "varieti": 84, "estim": [84, 86], "method": [84, 86, 87], "avail": 84, "movi": 84, "descript": 84, "person": 84, "us": 84, "movielen": [84, 91], "dso": [85, 86], "effici": 85, "problem": 86, "formul": 86, "gradient": [85, 86], "pg": 86, "regress": 86, "import": [85, 86], "sampl": [85, 86], "i": [85, 86, 91], "doubli": 86, "robust": 86, "dr": 86, "potec": 86, "direct": [85, 86], "sentenc": [85, 86, 91], "dm": 86, "invers": 86, "propens": 86, "score": 86, "ip": 86, "citep": 86, "strehl2010learn": 86, "offcem": 86, "kernel": [85, 86], "onlin": 86, "evalut": 86, "learn": [86, 87], "reinforc": 86, "evalu": [86, 87], "comparison": [85, 86], "overview": 87, "class": 87, "support": 87, "off": [85, 87], "correspond": 87, "citat": [85, 87, 88, 91], "contact": 87, "tabl": 87, "content": 87, "get": 87, "start": 87, "see": 87, "also": 87, "instal": 88, "welcom": 92, "The": 85, "issu": 85, "typic": [], "theoret": 85, "properti": 85, "experi": 85, "vanilla": 85, "perform": 85, "baselin": 85, "ablat": 85, "studi": 85, "about": 85, "real": [], "usag": 91, "set": 91, "up": 91, "environ": 91, "preprocess": 91, "ii": 91, "retriev": 91, "candid": 91, "keyword": 91, "prompt": 91, "iii": 91, "finetun": 91, "reward": 91, "v": 91, "embed": 91, "queri": 91, "pca": 91, "matrix": 91, "custom": 91, "interact": 91, "user": 91, "matric": 91, "quickstart": 90, "new": 89}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinxcontrib.bibtex": 9, "sphinx": 57}, "alltitles": {"off_prompts.dataset.assets.reward_finetuner": [[0, "module-off_prompts.dataset.assets.reward_finetuner"]], "off_prompts.dataset.assets.reward_finetuner.MovielensDataset": [[1, "off-prompts-dataset-assets-reward-finetuner-movielensdataset"]], "off_prompts.dataset.assets.reward_finetuner.RewardFinetuner": [[2, "off-prompts-dataset-assets-reward-finetuner-rewardfinetuner"]], "off_prompts.dataset.assets.sentence_embedding_learner": [[3, "module-off_prompts.dataset.assets.sentence_embedding_learner"]], "off_prompts.dataset.assets.sentence_embedding_learner.SentenceEmbeddingLearner": [[4, "off-prompts-dataset-assets-sentence-embedding-learner-sentenceembeddinglearner"]], "off_prompts.dataset.base": [[5, "module-off_prompts.dataset.base"]], "off_prompts.dataset.base.BaseCandidateActionsLoader": [[6, "off-prompts-dataset-base-basecandidateactionsloader"]], "off_prompts.dataset.base.BaseContextQueryLoader": [[7, "off-prompts-dataset-base-basecontextqueryloader"]], "off_prompts.dataset.base.BaseEncoder": [[8, "off-prompts-dataset-base-baseencoder"]], "off_prompts.dataset.base.BaseFrozenLLM": [[9, "off-prompts-dataset-base-basefrozenllm"]], "off_prompts.dataset.base.BasePromptFormatter": [[10, "off-prompts-dataset-base-basepromptformatter"]], "off_prompts.dataset.base.BaseRewardSimulator": [[11, "off-prompts-dataset-base-baserewardsimulator"]], "off_prompts.dataset.benchmark": [[12, "module-off_prompts.dataset.benchmark"]], "off_prompts.dataset.benchmark.SemiSyntheticDataset": [[13, "off-prompts-dataset-benchmark-semisyntheticdataset"]], "off_prompts.dataset.encoder": [[14, "module-off_prompts.dataset.encoder"]], "off_prompts.dataset.encoder.BatchDataset": [[15, "off-prompts-dataset-encoder-batchdataset"]], "off_prompts.dataset.encoder.NNSentenceEncoder": [[16, "off-prompts-dataset-encoder-nnsentenceencoder"]], "off_prompts.dataset.encoder.TransformerEncoder": [[17, "off-prompts-dataset-encoder-transformerencoder"]], "off_prompts.dataset.frozen_llm": [[18, "module-off_prompts.dataset.frozen_llm"]], "off_prompts.dataset.frozen_llm.AutoFrozenLLM": [[19, "off-prompts-dataset-frozen-llm-autofrozenllm"]], "off_prompts.dataset.function": [[20, "module-off_prompts.dataset.function"]], "off_prompts.dataset.function.DefaultCandidateActionsLoader": [[21, "off-prompts-dataset-function-defaultcandidateactionsloader"]], "off_prompts.dataset.function.DefaultContextQueryLoader": [[22, "off-prompts-dataset-function-defaultcontextqueryloader"]], "off_prompts.dataset.prompt_formatter": [[23, "module-off_prompts.dataset.prompt_formatter"]], "off_prompts.dataset.prompt_formatter.MovielensPromptFormatter": [[24, "off-prompts-dataset-prompt-formatter-movielenspromptformatter"]], "off_prompts.dataset.reward_simulator": [[25, "module-off_prompts.dataset.reward_simulator"]], "off_prompts.dataset.reward_simulator.CollaborativeFilteringRewardSimulator": [[26, "off-prompts-dataset-reward-simulator-collaborativefilteringrewardsimulator"]], "off_prompts.dataset.reward_simulator.PromptCossimRewardSimulator": [[27, "off-prompts-dataset-reward-simulator-promptcossimrewardsimulator"]], "off_prompts.dataset.reward_simulator.SentenceCossimRewardSimulator": [[28, "off-prompts-dataset-reward-simulator-sentencecossimrewardsimulator"]], "off_prompts.dataset.reward_simulator.TransformerRewardSimulator": [[29, "off-prompts-dataset-reward-simulator-transformerrewardsimulator"]], "off_prompts_syn.dataset.function": [[30, "module-off_prompts_syn.dataset.function"]], "off_prompts_syn.dataset.function.AuxiliaryOutputGenerator": [[31, "off-prompts-syn-dataset-function-auxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.CandidateActionsGenerator": [[32, "off-prompts-syn-dataset-function-candidateactionsgenerator"]], "off_prompts_syn.dataset.function.ConfoundedAuxiliaryOutputGenerator": [[33, "off-prompts-syn-dataset-function-confoundedauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.ConfoundedExponentialAuxiliaryOutputGenerator": [[34, "off-prompts-syn-dataset-function-confoundedexponentialauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.ConfoundedPowerAuxiliaryOutputGenerator": [[35, "off-prompts-syn-dataset-function-confoundedpowerauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.ConfoundedRationalAuxiliaryOutputGenerator": [[36, "off-prompts-syn-dataset-function-confoundedrationalauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.ConfoundedTrigonometricAuxiliaryOutputGenerator": [[37, "off-prompts-syn-dataset-function-confoundedtrigonometricauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.ContextQueryGenerator": [[38, "off-prompts-syn-dataset-function-contextquerygenerator"]], "off_prompts_syn.dataset.function.ExponentialAuxiliaryOutputGenerator": [[39, "off-prompts-syn-dataset-function-exponentialauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.MixtureOfGaussianCandidateActionsGenerator": [[40, "off-prompts-syn-dataset-function-mixtureofgaussiancandidateactionsgenerator"]], "off_prompts_syn.dataset.function.PowerAuxiliaryOutputGenerator": [[41, "off-prompts-syn-dataset-function-powerauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.RationalAuxiliaryOutputGenerator": [[42, "off-prompts-syn-dataset-function-rationalauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.RewardSimulator": [[43, "off-prompts-syn-dataset-function-rewardsimulator"]], "off_prompts_syn.dataset.function.SigmoidAuxiliaryOutputGenerator": [[44, "off-prompts-syn-dataset-function-sigmoidauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.function.SparseRewardSimulator": [[45, "off-prompts-syn-dataset-function-sparserewardsimulator"]], "off_prompts_syn.dataset.function.TrigonometricAuxiliaryOutputGenerator": [[46, "off-prompts-syn-dataset-function-trigonometricauxiliaryoutputgenerator"]], "off_prompts_syn.dataset.synthetic": [[47, "module-off_prompts_syn.dataset.synthetic"]], "off_prompts_syn.dataset.synthetic.SyntheticDataset": [[48, "off-prompts-syn-dataset-synthetic-syntheticdataset"]], "off_prompts.utils": [[65, "module-off_prompts.utils"]], "off_prompts.utils.FrozenLLMDataset": [[66, "off-prompts-utils-frozenllmdataset"]], "off_prompts.utils.RewardSimulatorDataset": [[67, "off-prompts-utils-rewardsimulatordataset"]], "off_prompts.utils.check_logged_feedback": [[68, "off-prompts-utils-check-logged-feedback"]], "off_prompts.utils.check_tensor": [[69, "off-prompts-utils-check-tensor"]], "off_prompts.utils.defaultdict_to_dict": [[70, "off-prompts-utils-defaultdict-to-dict"]], "off_prompts.utils.gaussian_kernel": [[71, "off-prompts-utils-gaussian-kernel"]], "off_prompts.utils.to_device": [[72, "off-prompts-utils-to-device"]], "off_prompts.utils.tokenize": [[73, "off-prompts-utils-tokenize"]], "off_prompts.utils.torch_seed": [[74, "off-prompts-utils-torch-seed"]], "off_prompts.utils.uniform_kernel": [[75, "off-prompts-utils-uniform-kernel"]], "off_prompts_syn.utils": [[76, "module-off_prompts_syn.utils"]], "off_prompts_syn.utils.check_logged_feedback": [[77, "off-prompts-syn-utils-check-logged-feedback"]], "off_prompts_syn.utils.check_tensor": [[78, "off-prompts-syn-utils-check-tensor"]], "off_prompts_syn.utils.defaultdict_to_dict": [[79, "off-prompts-syn-utils-defaultdict-to-dict"]], "off_prompts_syn.utils.gaussian_kernel": [[80, "off-prompts-syn-utils-gaussian-kernel"]], "off_prompts_syn.utils.torch_seed": [[81, "off-prompts-syn-utils-torch-seed"]], "off_prompts_syn.utils.uniform_kernel": [[82, "off-prompts-syn-utils-uniform-kernel"]], "OfflinePrompts Package Reference": [[83, "offlineprompts-package-reference"]], "Full-LLM benchmark": [[83, "full-llm-benchmark"]], "Dataset module": [[83, "dataset-module"], [83, "api-dataset-syn"]], "Policy module": [[83, "policy-module"], [83, "api-policy-syn"]], "OPE/L module": [[83, "ope-l-module"], [83, "api-opl-syn"]], "Others": [[83, "others"], [83, "api-utils-syn"]], "Synthetic simulation": [[83, "synthetic-simulation"]], "Why OfflinePrompts?": [[84, "why-offlineprompts"]], "Motivation": [[84, "motivation"]], "Key contributions": [[84, "key-contributions"]], "End-to-end implementation of data collection, OPE/L, and LLM-based generation": [[84, "end-to-end-implementation-of-data-collection-ope-l-and-llm-based-generation"]], "Variety of OPE estimators and OPL methods available": [[84, "variety-of-ope-estimators-and-opl-methods-available"]], "Movie description personalization using MovieLens": [[84, "movie-description-personalization-using-movielens"]], "Problem Formulation and Implementations": [[86, "problem-formulation-and-implementations"]], "Problem Formulation": [[86, "problem-formulation"]], "OPL methods": [[86, "opl-methods"]], "Policy gradient (PG)": [[86, "policy-gradient-pg"]], "Regression [].": [[86, "regression-konda1999actor"]], "Importance sampling (IS) []": [[86, "importance-sampling-is-swaminathan2015batch"]], "Doubly Robust (DR) []": [[86, "doubly-robust-dr-dudik2011doubly"], [86, "id17"]], "POTEC []": [[86, "potec-saito2024potec"]], "Direct Sentence (DSO) []": [[86, "direct-sentence-dso-kiyohara2024prompt"]], "OPE estimators": [[86, "ope-estimators"]], "Direct Method (DM) []": [[86, "direct-method-dm-beygelzimer2009offset"]], "Inverse Propensity Scoring (IPS) :citep:`strehl2010learning`": [[86, "inverse-propensity-scoring-ips-citep-strehl2010learning"]], "OffCEM []": [[86, "offcem-saito2023off"]], "Kernel IS []": [[86, "kernel-is-kiyohara2024prompt"]], "Online evalution and learning": [[86, "online-evalution-and-learning"]], "REINFORCE []": [[86, "reinforce-sutton2018reinforcement-deng2022rlprompt"]], "Online evaluation": [[86, "online-evaluation"]], "Comparison of the implemented OPE/L methods": [[86, "comparison-of-the-implemented-ope-l-methods"]], "Installation": [[88, "installation"]], "Citation": [[88, "citation"], [85, "citation"], [91, "citation"], [87, "citation"]], "Quickstart": [[90, "quickstart"]], "DSO for Data-Efficient OPL": [[85, "dso-for-data-efficient-opl"]], "The issue of vanilla importance sampling (IS)": [[85, "the-issue-of-vanilla-importance-sampling-is"]], "Direct Sentence Off-Policy Gradient (DSO)": [[85, "direct-sentence-off-policy-gradient-dso"]], "Theoretical Properties": [[85, "theoretical-properties"]], "Experiments": [[85, "experiments"]], "Performance comparison with baselines": [[85, "performance-comparison-with-baselines"]], "Ablation study about kernels": [[85, "ablation-study-about-kernels"]], "Full-LLM experiment": [[85, "full-llm-experiment"]], "Usage": [[91, "usage"]], "Setting up the full-LLM environment with MovieLens": [[91, "setting-up-the-full-llm-environment-with-movielens"]], "(i) Preprocess the MovieLens dataset.": [[91, "i-preprocess-the-movielens-dataset"]], "(ii) Retrieve candidate (keyword) prompts.": [[91, "ii-retrieve-candidate-keyword-prompts"]], "(iii) Finetune a reward simulator.": [[91, "iii-finetune-a-reward-simulator"]], "(v) Retrieve prompt embeddings, query embeddings, and PCA matrix of sentence encoders.": [[91, "v-retrieve-prompt-embeddings-query-embeddings-and-pca-matrix-of-sentence-encoders"]], "Setting up the full-LLM environment with custom dataset": [[91, "setting-up-the-full-llm-environment-with-custom-dataset"]], "Interaction data": [[91, "interaction-data"]], "Candidate prompts": [[91, "candidate-prompts"]], "Queries": [[91, "queries"]], "User, query, prompt embeddings": [[91, "user-query-prompt-embeddings"]], "PCA matrices": [[91, "pca-matrices"]], "Reward simulator": [[91, "reward-simulator"]], "off_prompts.opl.behavior_cloning": [[49, "off-prompts-opl-behavior-cloning"]], "off_prompts.opl.dataset": [[50, "off-prompts-opl-dataset"]], "off_prompts.opl.marginal_learner": [[51, "off-prompts-opl-marginal-learner"]], "off_prompts.opl.policy_evaluator": [[52, "off-prompts-opl-policy-evaluator"]], "off_prompts.opl.policy_learner": [[53, "off-prompts-opl-policy-learner"]], "off_prompts.opl.reward_learner": [[54, "off-prompts-opl-reward-learner"]], "off_prompts_syn.opl.behavior_cloning": [[55, "off-prompts-syn-opl-behavior-cloning"]], "off_prompts_syn.opl.marginal_learner": [[56, "off-prompts-syn-opl-marginal-learner"]], "off_prompts_syn.opl.policy_learner": [[57, "off-prompts-syn-opl-policy-learner"]], "off_prompts_syn.opl.reward_learner": [[58, "off-prompts-syn-opl-reward-learner"]], "off_prompts.policy.base": [[59, "off-prompts-policy-base"]], "off_prompts.policy.model": [[60, "off-prompts-policy-model"]], "off_prompts.policy.policy": [[61, "off-prompts-policy-policy"]], "off_prompts_syn.policy.base": [[62, "off-prompts-syn-policy-base"]], "off_prompts_syn.policy.model": [[63, "off-prompts-syn-policy-model"]], "off_prompts_syn.policy.policy": [[64, "off-prompts-syn-policy-policy"]], "OfflinePrompts": [[87, "offlineprompts"]], "Overview": [[87, "overview"]], "Implementation": [[87, "implementation"]], "Simulations and Data Collection Policy": [[87, "simulations-and-data-collection-policy"]], "Dataset class": [[87, "dataset-class"]], "Support classes": [[87, "support-classes"]], "Policy": [[87, "policy"]], "Off-Policy Evaluation and Learning (OPE/L)": [[87, "off-policy-evaluation-and-learning-ope-l"]], "Learning methods": [[87, "learning-methods"]], "Corresponding evaluation methods": [[87, "corresponding-evaluation-methods"]], "Contact": [[87, "contact"]], "Contribution": [[87, "contribution"]], "Table of Contents": [[87, "table-of-contents"]], "Getting Started:": [[87, null]], "See also:": [[87, null]], "News": [[89, "news"]], "Welcome!": [[92, "welcome"]]}, "indexentries": {}})